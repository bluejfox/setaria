/*! Setaria.js 25-08-2016 */
var _action=new function(){function a(a,b){var c=function(){try{_handler.doPreProcess&&_handler.doPreProcess(b),a.call(null,b)}catch(c){_log.error(c.stack?c.stack:c),_handler.doCatch&&_handler.doCatch(c,b)}finally{_handler.doFinally&&_handler.doFinally(b)}};c.apply(this)}this.doAction=a},_config=new function(){this.createCacheToken=function(){return this.APP_REVISION?this.APP_REVISION:Math.floor(1e14*Math.random())}},_cookie=new function(){var a=function(a){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null};this.getItem=a;var b=function(a,b,c,d,e,f){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var g="";if(c)switch(c.constructor){case Number:g=c===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:g="; expires="+c;break;case Date:g="; expires="+c.toUTCString()}return document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+g+(e?"; domain="+e:"")+(d?"; path="+d:"")+(f?"; secure":""),!0};this.setItem=b;var c=function(a,b,c){return!(!a||!this.hasItem(a))&&(document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(c?"; domain="+c:"")+(b?"; path="+b:""),!0)};this.removeItem=c;var d=function(a){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)};this.hasItem=d},_globalParam=new function(){function a(){var a=j.getItem(k)||"{}";return JSON.parse(a)}function b(a){j.setItem(k,JSON.stringify(a))}function c(c){if(_util.isEmpty(c))j.removeItem(k);else{var d=a();delete d[c],b(d)}}function d(c,d){var e=a();d=d?d:"",e[c]=d,b(e)}function e(b){var c=a();return c[b]}function f(a){c(a)}function g(a,b){d(a,b)}function h(a){return e(a)}function i(a){f(a)}var j=window.localStorage,k="___global_param__";this.set=g,this.get=h,this.clear=i},_handler=new function(){function a(a){}function b(a,b){a=a.message?a:new SystemMessage("SESYSM002E"),_ui.showMessage(a,"error")}function c(a){d(a)&&a.preventDefault()}function d(a){var b=!1,c=null;return a&&a.target&&("FORM"===a.target.nodeName?b=!0:"A"===a.target.nodeName&&a.target.href.lastIndexOf("#")===a.target.href.length-1?b=!0:$(a.target).parents("a").length>0&&(c=$(a.target).parents("a")[0],c.href.lastIndexOf("#")===c.href.length-1&&(b=!0))),b}this.doPreProcess=a,this.doCatch=b,this.doFinally=c},_html=new function(){function a(a){var b=null;return _util.isEmpty(a)||(b=s(a)?t(a):_util.escape(p(a).val())),b}function b(a){}function c(a,b){var c=p(a);if(c.is("form")&&_util.isObject(b)){var d=null;for(d in b)this.setFormItemValueByName(d,b[d])}else c.val(b)}function d(a,b){var c=$("name=["+a+"]");c.is(":checkbox")||c.is(":radio")?c.each(function(){this.val()===b?this.prop("checked",!0):this.prop("checked",!1)}):c.val(b)}function e(a){var b=p(a);return b.length>0?b[0]:null}function f(a,b){var c=!0;return c}function g(a){p(a).show()}function h(a){p(a).hide()}function i(a){p(a).prop("disabled",!1)}function j(a){p(a).prop("disabled",!0)}function k(a){p(a).remove()}function l(a){var b=a.getAttribute("id");_util.isEmpty(b)?$(a).remove():p(b).remove()}function m(a,b,c){q(b,p(a),c)}function n(a,b,c){q(b,$("[name='"+a+"']"),c)}function o(a,b){r(b,p(a))}var p=function(a){return a=0===a.indexOf("#")?a:"#"+a,$(a)},q=function(a,b,c){b.on(a,function(a){_action.doAction(c,a)})},r=function(a,b){b.off(a)},s=function(a){return"FORM"===p(a).prop("tagName")},t=function(a){var b={},c=p(a).serializeArray();return $.each(c,function(){_util.isEmpty(b[this.name])?b[this.name]=this.value||"":(_util.isArray(b[this.name])||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||""))}),b};this.getValue=a,this.getFormItemValueByName=b,this.setValue=c,this.setFormItemValueByName=d,this.byId=e,this.validate=f,this.show=g,this.hide=h,this.enable=i,this.disable=j,this.removeDomNodeById=k,this.removeDomNode=l,this.bindEventById=m,this.bindEventByName=n,this.unBindEventById=o},_http=new function(){function a(a){_util.isEmpty(a)||(a.async=!0,c(a))}function b(a){_util.isEmpty(a)||(a.async=!1,c(a))}var c=function(a){if(!_util.isEmpty(a)){_config.DEFAULT_TIMEOUT||2e4;return a.timeout=_util.get(a,"timeout",_config.DEFAULT_TIMEOUT),_util.isFunction(a.error)?a.error=a.error:a.error=d,$.ajax(a)}},d=function(a,b,c){var d,e=[];d="timeout"===b?new SystemMessage("SESYSM005E"):a.statusText,e.push(d),_ui.showMessage(e,"error")};this.doAsync=a,this.doSync=b},_log=new function(){function a(a){console.log(a)}function b(a){var b=a.messageId;b=_util.isEmpty(b)?"":b+" ",console.error(b+a)}this.debug=a,this.error=b},_message=new function(){function a(a,b){var c=e(a);return c?g(c,b):"没有找到指定的消息. (id="+a+", parameters="+b+")"}function b(a,b){var c=f(a);return c?g(c,b):"message not found. (id="+a+", parameters="+b+")"}var c=null,d=null,e=function(a){return _util.isEmpty(c)&&(c=_util.getFileContent(_config.MESSAGE_FILE,"json")),c[a]},f=function(a){return _util.isEmpty(d)&&(d=_util.getFileContent(_config.SYSMESSAGE_FILE,"json")),d[a]},g=function(a,b){if(!_util.isEmpty(b))for(var c=0;c<b.length;c++)a=a.split("{"+c+"}").join(b[c]);return a};this.getMessage=a,this.getSystemMessage=b},_setaria=new function(){var a=function(){$("script").each(function(){var a=$(this).attr("data-setaria-config");_util.isEmpty(a)||(configContent=_util.getFileContent(a,"json"),_util.isEmpty(configContent)?_ui.showMessage(new SystemMessage("SESYSM003E")):$.each(configContent,function(a,b){_config[a]=b}))})},b=function(){a();var b=_config.VIEWMODEL_CONFIG_FILE;window._viewModelController=new ViewModelController(b),this.bindHashChange(),this.dispatcher()};this.start=b;var c=function(){$(window).on("hashchange",this.doHashChange)};this.bindHashChange=c;var d=function(){var a=_url.getHashParams();_util.isEmpty(a)||_ui.forwardTo.apply(_ui,a)};this.doHashChange=d;var e=function(){this.defaultDispatcher()};this.dispatcher=e;var f=function(){var a=_url.getHashParams();_util.isEmpty(a)?_ui.forwardTo(_config.WELCOME_PAGE):_ui.forwardTo.apply(_ui,a)};this.defaultDispatcher=f},_ui=new function(){function a(a){alert("Dialog -> title :: "+a.title+", message :: "+a.message)}function b(a){var b=$("#"+_config.LOADING_ID);a?b.show():b.hide()}function c(a,b,c){var d=[],e="",f=null;_util.isEmpty(a)||(_util.isArray(a)?$.each(a,function(a,b){d.push(b.message?b.message:b),d.push(g)}):(e=a.messageId||"",d.push(_util.isObject(a)?a.message:a)),_util.isFunction(c)&&(f=function(){c()}),this.showDialog({title:"error"!==b?"消息":"错误",type:b,message:d.join(""),cancelText:"关闭",cancelCallback:f,cancelOnly:!0}))}function d(a,b,c,d,e){a=_util.isEmpty(a)?"确认窗口":a,cancelOnly=_util.isEmpty(e)&&!_util.isEmpty(d),e=e||"确认",d=d||"取消";var f=function(){c(!0)},g=function(){c(!1)};this.showDialog({title:a,message:b,doneText:e,cancelText:d,doneCallback:f,cancelCallback:g,cancelOnly:cancelOnly})}function e(a){_viewModelController.forwardTo.apply(_viewModelController,arguments)}function f(a){_viewModelController.backTo.apply(_viewModelController,arguments)}var g="<br>";this.showDialog=a,this.toggleProcessing=b,this.showMessage=c,this.showModalDialog=d,this.forwardTo=e,this.backTo=f;var h=function(a,b){var c=null;_util.isEmpty(a)||(c=_util.getFileContent(a,"html"),$("#"+_config.MAIN_AREA_ID).html(c)),b()};this.updateHTML=h},_url=new function(){var a="/",b=function(){var b=null,c=window.location.hash;return _util.isEmpty(c)||0!==c.indexOf("#")||(c=c.substring(1),b=c.split(a)),b};this.getHashParams=b;var c=function(){var a="",b=this.getHashParams();return _util.isEmpty(b)||(a=b[0]),a};this.getPageId=c;var d=function(a,b){var c=a,d="",e="",f=0;return _util.isEmpty(a)||(f=a.indexOf("#"),f!==-1&&(e=a.substring(f),c=a.substring(0,f)),d=c.indexOf("?")!==-1?"&":"?",c+=d+$.param(b),_util.isEmpty(e)||(c+=e)),c};this.setUrlParameter=d;var e=function(a){for(var b={},c=window.location.search.substring(1),d=c.split("&"),e=null,f=0;f<d.length;f++)if(e=d[f].split("="),_util.isEmpty(a))b[e[0]]=e[1];else if(e[0]===a){b=e[1];break}return b};this.getUrlParameter=e;var f=function(a,b){b?window.location.replace(a):window.location.href=a};this.redirectTo=f;var g=function(a){this.redirectTo(_config.HTML_ROOT_DIR+_config.HTML_ERROR_DIR+a+".html",!0)};this.redirectToErrorPage=g;var h=function(){var a=window.location.search,b=window.location.href;b=b.replace(a,""),window.history.replaceState(null,null,b)};this.clearUrlParameter=h;var i=function(){var a=window.location.href;a.indexOf("#")!==-1&&(a=a.substring(0,a.indexOf("#"))),window.history.replaceState(null,null,a)};this.clearHash=i},_util=new function(){"use strict";function a(a){return A[a]}function b(a){return!!a&&"object"==typeof a}function c(a){return"number"==typeof a&&a>-1&&a%1===0&&a<=x}function d(a){return o(a)?a:Object(a)}function e(a,b,c){if(null!==a&&void 0!==a){void 0!==c&&c in d(a)&&(b=[c]);for(var e=0,f=b.length;null!==a&&e<f;)a=a[b[e++]];return e&&e==f?a:void 0}}function f(a){if(n(a))return a;var b=[];return g(a).replace(y,function(a,c,d,e){b.push(d?e.replace(z,"$1"):c||a)}),b}function g(a){return null===a?"":a+""}function h(a){return function(b){return null===b?void 0:b[a]}}function i(a){return null!==a&&c(G(a))}function j(a){return null===a||void 0===a||(i(a)&&(n(a)||k(a)||q(a)||b(a)&&p(a.splice))?!a.length:!t(a).length)}function k(a){return"string"==typeof a||b(a)&&"[object String]"==Object.prototype.toString.call(a)}function l(a){return"number"==typeof a||b(a)&&"[object Number]"==Object.prototype.toString.call(a)}function m(a){return a===!0||a===!1||b(a)&&"[object Boolean]"==Object.prototype.toString.call(a)}function n(a){return b(a)&&c(a.length)&&"[object Array]"==Object.prototype.toString.call(a)}function o(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function p(a){return o(a)&&"[object Function]"==Object.prototype.toString.call(a)}function q(a){return b(a)&&i(a)&&E.call(a,"callee")&&!F.call(a,"callee")}function r(a,b){return E.call(a,b)}function s(a,b,c){var d=null===a?void 0:e(a,f(b),b+"");return void 0===d?c:d}function t(a){return o(a)?Object.keys(a):[]}function u(a,b){var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b}function v(b){return b=g(b),b&&D.test(b)?b.replace(C,a):b}function w(a,b){var c=null,d=window.location.pathname,e=0,f=window.location.origin,g=new HTTPContext;return _util.isEmpty(d)||"/"===d||(d=d.substring(1),d.split("/")[0].indexOf(".")===-1?(e=d.indexOf("/"),e!==-1&&(d="/"+d.substring(0,e+1))):d="/"),f+=d+a,g.url=f+"?_="+_config.createCacheToken(),g.method="GET",g.dataType=b?b:"text",g.success=function(a){c=a},_http.doSync(g),c}var x=9007199254740991,y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,z=/\\(\\)?/g,A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},B=/&(?:amp|lt|gt|quot|#39|#96);/g,C=/[&<>"'`]/g,D=(RegExp(B.source),RegExp(C.source)),E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable,G=h("length");this.isEmpty=j,this.isString=k,this.isNumber=l,this.isBoolean=m,this.isArray=n,this.isObject=o,this.isFunction=p,this.isArguments=q,this.has=r,this.get=s,this.keys=t,this.dateFormat=u,this.escape=v,this.getFileContent=w},HTTPContext=function(a,b,c,d,e,f,g,h,i){this.url=a,this.method=b,this.dataType=c,this.contentType=d,this.data=e,this.success=f,this.error=g,this.complete=h,this.beforeSend=i},Message=function(a,b){function c(){return this.message}this.messageId=a,this.message=_message.getMessage(a,b),this.toString=c},SystemMessage=function(a,b){function c(){return this.message}this.messageId=a,this.message=_message.getSystemMessage(a,b),this.toString=c},ValidationMessage=function(a,b,c){function d(){return this.message}this.elementId=a,this.messageId=b,this.message=_message.getMessage(b,c),this.toString=d},ViewModelController=function(a,b){var c=null,d={},e=function(a,b,c){var d=_config.SRC_ROOT_DIR+b+".js",e=b.substring(b.lastIndexOf("/")+1);if(_util.isFunction(window[e]))c.call(null,window[e]);else{var f=document.createElement("script");f.type="text/javascript",f.charset="utf-8",f.src=d+"?_="+_config.createCacheToken(),f.addEventListener("load",function(){c.call(null,window[e])}.bind(this),!1),f.async=!0,document.querySelector("head").appendChild(f)}};this.loadScript=e;var f=function(){c=_util.getFileContent(a,"json")};this.initialViewModelConfig=f,this.initialViewModelConfig();var g=function(a){var b=c[a],e=arguments;b?_ui.updateHTML(this.getTemplatePath(b.template),function(){_util.isEmpty(b.viewModelClass)||this.loadScript(b,b.viewModelClass,function(b){if(_util.isFunction(b)){var c=b.bind.apply(b,e),f=new c;f.cache={},_action.doAction(f.init.bind(f)),d[a]=f}})}.bind(this)):_ui.showMessage(new SystemMessage("SESYSM001E",[a]),"error")};this.forwardTo=g;var h=function(a){var b=c[a];_util.isEmpty(b)?_ui.showMessage(new SystemMessage("SESYSM001E",[a]),"error"):_ui.updateHTML(this.getTemplatePath(b.template),function(){d[a]&&d[a].init()})};this.backTo=h;var i=function(a){var b="";return _util.isEmpty(a)||(b=_config.HTML_ROOT_DIR+a),b};this.getTemplatePath=i;var j=function(){return c};this.getViewModelConfig=j};