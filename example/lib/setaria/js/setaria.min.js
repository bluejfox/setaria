/*! Setaria.js 12-09-2016 */
var _action=new function(){"use strict";this.doAction=function(a,b){var c=function(){try{_handler.doPreProcess&&_handler.doPreProcess(b),a.call(null,b)}catch(c){_log.error(c.stack?c.stack:c),_handler.doCatch&&_handler.doCatch(c,b)}finally{_handler.doFinally&&_handler.doFinally(b)}};c.apply(this)}},_config=new function(){"use strict";this.createCacheToken=function(){return this.APP_REVISION?this.APP_REVISION:Math.floor(1e14*Math.random())},this.getMobileOperatingSystem=function(){var a=navigator.userAgent||navigator.vendor||window.opera,b="unknown";return/windows phone/i.test(a)?b="Windows Phone":/android/i.test(a)?b="Android":/iPad|iPhone|iPod/.test(a)&&!window.MSStream&&(b="iOS"),b}},_cookie=new function(){"use strict";this.getItem=function(a){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},this.setItem=function(a,b,c,d,e,f){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var g="";if(c)switch(c.constructor){case Number:g=c===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:g="; expires="+c;break;case Date:g="; expires="+c.toUTCString()}return document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+g+(e?"; domain="+e:"")+(d?"; path="+d:"")+(f?"; secure":""),!0},this.removeItem=function(a,b,c){return!(!a||!this.hasItem(a))&&(document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(c?"; domain="+c:"")+(b?"; path="+b:""),!0)},this.hasItem=function(a){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},_globalParam=new function(){"use strict";function a(){var a=g.getItem(h)||"{}";return JSON.parse(a)}function b(a){g.setItem(h,JSON.stringify(a))}function c(c){if(_util.isEmpty(c))g.removeItem(h);else{var d=a();delete d[c],b(d)}}function d(c,d){var e=a();d=d?d:"",e[c]=d,b(e)}function e(b){var c=a();return c[b]}function f(a){c(a)}var g=window.localStorage,h="___global_param__";this.set=function(a,b){d(a,b)},this.get=function(a){return e(a)},this.clear=function(a){f(a)}},_handler=new function(){"use strict";function a(a){var b=!1,c=null;return a&&a.target&&("FORM"===a.target.nodeName?b=!0:"A"===a.target.nodeName&&a.target.href.lastIndexOf("#")===a.target.href.length-1?b=!0:$(a.target).parents("a").length>0&&(c=$(a.target).parents("a")[0],c.href.lastIndexOf("#")===c.href.length-1&&(b=!0))),b}this.doPreProcess=function(a){},this.doCatch=function(a,b){a=a.message?a:new SystemMessage("SESYSM002E"),_ui.showMessage(a,"error")},this.doFinally=function(b){a(b)&&b.preventDefault()}},_html=new function(){"use strict";function a(a){return a=0===a.indexOf("#")?a:"#"+a,$(a)}function b(a,b,c){b.on(a,function(a){_action.doAction(c,a)})}function c(a,b){b.off(a)}function d(b){return"FORM"===a(b).prop("tagName")}function e(b){var c={},d=a(b).serializeArray();return $.each(d,function(){_util.isEmpty(c[this.name])?c[this.name]=this.value||"":(_util.isArray(c[this.name])||(c[this.name]=[c[this.name]]),c[this.name].push(this.value||""))}),c}this.getValue=function(b){var c=null;return _util.isEmpty(b)||(c=d(b)?e(b):_util.escape(a(b).val())),c},this.getFormItemValueByName=function(a){},this.setValue=function(b,c){var d=a(b);if(d.is("form")&&_util.isObject(c)){var e=null;for(e in c)this.setFormItemValueByName(e,c[e])}else d.val(c)},this.setFormItemValueByName=function(a,b){var c=$("name=["+a+"]");c.is(":checkbox")||c.is(":radio")?c.each(function(){this.val()===b?this.prop("checked",!0):this.prop("checked",!1)}):c.val(b)},this.byId=function(b){var c=a(b);return c.length>0?c[0]:null},this.validate=function(a,b){var c=!0;return c},this.show=function(b){a(b).show()},this.hide=function(b){a(b).hide()},this.enable=function(b){a(b).prop("disabled",!1)},this.disable=function(b){a(b).prop("disabled",!0)},this.removeDomNodeById=function(b){a(b).remove()},this.removeDomNode=function(b){var c=b.getAttribute("id");_util.isEmpty(c)?$(b).remove():a(c).remove()},this.bindEventById=function(c,d,e){b(d,a(c),e)},this.bindEventByName=function(a,c,d){b(c,$("[name='"+a+"']"),d)},this.unBindEventById=function(b,d){c(d,a(b))}},_http=new function(){"use strict";function a(a){if(!_util.isEmpty(a)){_config.DEFAULT_TIMEOUT||2e4;return a.timeout=_util.get(a,"timeout",_config.DEFAULT_TIMEOUT),_util.isFunction(a.error)?a.error=a.error:a.error=b,$.ajax(a)}}function b(a,b,c){var d,e=[];d="timeout"===b?new SystemMessage("SESYSM005E"):a.statusText,e.push(d),_ui.showMessage(e,"error")}this.doAsync=function(b){_util.isEmpty(b)||(b.async=!0,a(b))},this.doSync=function(b){_util.isEmpty(b)||(b.async=!1,a(b))}},_log=new function(){"use strict";this.debug=function(a){"true"===_config.DEBUG_MODE&&console.log(a)},this.error=function(a){var b=a.messageId;b=_util.isEmpty(b)?"":b+" ",console.error(b+a)}},_message=new function(){"use strict";function a(a,b){var g=null,h=b===!0?_config.SYSMESSAGE_FILE:_config.MESSAGE_FILE,i=null;return b===!0?(_util.isEmpty(f)&&(f=_util.getFileContent(h,"json")),i=f):(_util.isEmpty(e)&&(e=_util.getFileContent(h,"json")),i=e),_util.isObject(i)&&"error"===i.textStatus?g=b===!0?d:c:(g=i[a],_util.isEmpty(g)&&(g="没有找到指定的消息。 (id="+a+")")),g}function b(a,b){if(!_util.isEmpty(b))for(var c=0;c<b.length;c++)a=a.split("{"+c+"}").join(b[c]);return a}var c="无法取得业务消息文件。",d="无法取得系统消息文件。",e=null,f=null;this.getMessage=function(c,d){return b(a(c,!1),d)},this.getSystemMessage=function(c,d){return b(a(c,!0),d)}},_setaria=new function(){"use strict";function a(){var a=!1;return $("script").each(function(){var b=$(this).attr("data-setaria-config"),c=null;if(!_util.isEmpty(b))return c=_util.getFileContent(b,"json"),_util.isEmpty(c)||!_util.isEmpty(c.textStatus)&&"error"===c.textStatus?_ui.showMessage("无法读取客户端系统配置文件。","error"):($.each(c,function(a,b){_config[a]=b}),a=!0),!1}),a}this.start=function(){var b=a();if(b){var c=_config.VIEWMODEL_CONFIG_FILE;window._viewModelController=new ViewModelController(c),this.bindHashChange(),this.dispatcher(window._viewModelController)}},this.bindHashChange=function(){$(window).on("hashchange",this.doHashChange)},this.doHashChange=function(){};var b=function(a){this.defaultDispatcher(a)};this.dispatcher=b,this.defaultDispatcher=function(a){var b=window.location.hash,c=null,d=null,e=[];_util.isEmpty(b)||"#"===b?_ui.forwardTo(_config.WELCOME_PAGE):(c=a.getViewPathFromHash(b),_util.isEmpty(c)?_ui.forwardTo(_config.WELCOME_PAGE):(e[0]=c,d=b.substring(b.indexOf(c)+c.length),e[1]=d,_ui.forwardTo.apply(_ui,e)))}},_ui=new function(){"use strict";var a="<br>";this.showDialog=function(a){alert("Dialog -> title :: "+a.title+", message :: "+a.message)},this.toggleProcessing=function(a){var b=$("#"+_config.LOADING_ID);a?b.show():b.hide()},this.showMessage=function(b,c,d){var e=[],f="",g=null;_util.isEmpty(b)||(_util.isArray(b)?$.each(b,function(b,c){e.push(c.message?c.message:c),e.push(a)}):_util.isObject(b)?(f=b.messageId||"",e.push(_util.isObject(b)?b.message:b)):e.push(b+""),_util.isFunction(d)&&(g=function(){d()}),this.showDialog({title:"error"!==c?"消息":"错误",type:c,message:e.join("<br/>"),doneText:"关闭",doneCallback:g,doneOnly:!0}))},this.showModalDialog=function(a,b,c,d,e){a=_util.isEmpty(a)?"确认窗口":a,doneOnly=_util.isEmpty(e)&&!_util.isEmpty(d),e=e||"确认",d=d||"取消";var f=function(){c(!0)},g=function(){c(!1)};this.showDialog({title:a,message:b,doneText:e,cancelText:d,doneCallback:f,cancelCallback:g,doneOnly:doneOnly})},this.forwardTo=function(a){_viewModelController.forwardTo.apply(_viewModelController,arguments)},this.backTo=function(a){_viewModelController.backTo.apply(_viewModelController,arguments)},this.updateHTML=function(a,b){var c=null;_util.isEmpty(a)||(c=_util.getFileContent(a,"html"),_util.isObject(c)?"error"===c.textStatus&&_ui.showMessage(new SystemMessage("SESYSM001E"),"error"):$("#"+_config.MAIN_AREA_ID).html(c)),b()},this.updateDocumentTitle=function(a){a=_util.isEmpty(a)?"":a,_util.isEmpty(a)||(document.title=a)}},_url=new function(){"use strict";var a="/";this.getHashParams=function(){var b=null,c=window.location.hash;return _util.isEmpty(c)||0!==c.indexOf("#")||(c=c.substring(1),b=c.split(a)),b},this.setUrlParameter=function(a,b){var c=a,d="",e="",f=0;return _util.isEmpty(a)||(f=a.indexOf("#"),f!==-1&&(e=a.substring(f),c=a.substring(0,f)),d=c.indexOf("?")!==-1?"&":"?",c+=d+$.param(b),_util.isEmpty(e)||(c+=e)),c},this.getUrlParameter=function(a){for(var b={},c=window.location.search.substring(1),d=c.split("&"),e=null,f=0;f<d.length;f++)if(e=d[f].split("="),_util.isEmpty(a))b[e[0]]=e[1];else if(e[0]===a){b=e[1];break}return b},this.redirectTo=function(a,b){b?window.location.replace(a):window.location.href=a},this.redirectToErrorPage=function(a){this.redirectTo(_config.HTML_ROOT_DIR+_config.HTML_ERROR_DIR+a+".html",!0)},this.clearUrlParameter=function(){var a=window.location.search,b=window.location.href;b=b.replace(a,""),window.history.replaceState(null,null,b)},this.clearHash=function(){var a=window.location.href;a.indexOf("#")!==-1&&(a=a.substring(0,a.indexOf("#"))),window.history.replaceState(null,null,a)}},_util=new function(){"use strict";function a(a){return m[a]}function b(a){return!!a&&"object"==typeof a}function c(a){return"number"==typeof a&&a>-1&&a%1===0&&a<=j}function d(a){return _util.isObject(a)?a:Object(a)}function e(a,b,c){if(null!==a&&void 0!==a){void 0!==c&&c in d(a)&&(b=[c]);for(var e=0,f=b.length;null!==a&&e<f;)a=a[b[e++]];return e&&e==f?a:void 0}}function f(a){if(_util.isArray(a))return a;var b=[];return g(a).replace(k,function(a,c,d,e){b.push(d?e.replace(l,"$1"):c||a)}),b}function g(a){return null===a?"":a+""}function h(a){return function(b){return null===b?void 0:b[a]}}function i(a){return null!==a&&c(s(a))}var j=9007199254740991,k=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,l=/\\(\\)?/g,m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},n=/&(?:amp|lt|gt|quot|#39|#96);/g,o=/[&<>"'`]/g,p=(RegExp(n.source),RegExp(o.source)),q=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=h("length");this.isEmpty=function(a){return null===a||void 0===a||(i(a)&&(this.isArray(a)||this.isString(a)||this.isArguments(a)||b(a)&&this.isFunction(a.splice))?!a.length:!this.keys(a).length)},this.isString=function(a){return"string"==typeof a||b(a)&&"[object String]"==Object.prototype.toString.call(a)},this.isNumber=function(a){return"number"==typeof a||b(a)&&"[object Number]"==Object.prototype.toString.call(a)},this.isBoolean=function(a){return a===!0||a===!1||b(a)&&"[object Boolean]"==Object.prototype.toString.call(a)},this.isArray=function(a){return b(a)&&c(a.length)&&"[object Array]"==Object.prototype.toString.call(a)},this.isObject=function(a){var b=typeof a;return!!a&&("object"==b||"function"==b)},this.isFunction=function(a){return this.isObject(a)&&"[object Function]"==Object.prototype.toString.call(a)},this.isArguments=function(a){return b(a)&&i(a)&&q.call(a,"callee")&&!r.call(a,"callee")},this.has=function(a,b){return q.call(a,b)},this.get=function(a,b,c){var d=null===a?void 0:e(a,f(b),b+"");return void 0===d?c:d},this.keys=function(a){return this.isObject(a)?Object.keys(a):[]},this.dateFormat=function(a,b){var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},this.escape=function(b){return b=g(b),b&&p.test(b)?b.replace(o,a):b},this.getFileContent=function(a,b){var c=null,d=window.location.pathname,e=0,f=window.location.origin,g=new HTTPContext;return _util.isEmpty(d)||"/"===d||(d=d.substring(1),d.split("/")[0].indexOf(".")===-1?(e=d.indexOf("/"),e!==-1&&(d="/"+d.substring(0,e+1))):d="/"),f+=d+a,g.url=f+"?_="+_config.createCacheToken(),g.method="GET",g.dataType=b?b:"text",g.error=function(a,b,d){c={jqXHR:a,textStatus:b,errorThrown:d}},g.success=function(a){c=a},_http.doSync(g),c}},HTTPContext=function(a,b,c,d,e,f,g,h,i){this.url=a,this.method=b,this.dataType=c,this.contentType=d,this.data=e,this.success=f,this.error=g,this.complete=h,this.beforeSend=i},Message=function(a,b){this.messageId=a,this.message=_message.getMessage(a,b),this.toString=function(){return this.message}},SystemMessage=function(a,b){this.messageId=a,this.message=_message.getSystemMessage(a,b),this.toString=function(){return this.message}},ValidationMessage=function(a,b,c){this.elementId=a,this.messageId=b,this.message=_message.getMessage(b,c),this.toString=function(){return this.message}},ViewModelController=function(a,b){function c(){d=_util.getFileContent(a,"json")}var d=null,e={};c(),this.loadScript=function(a,b,c){var d=_config.SRC_ROOT_DIR+b+".js",e=b.substring(b.lastIndexOf("/")+1);if(_util.isFunction(window[e]))c.call(null,window[e]);else{var f=document.createElement("script");f.type="text/javascript",f.charset="utf-8",f.src=d+"?_="+_config.createCacheToken(),f.addEventListener("load",function(){c.call(null,window[e])}.bind(this),!1),f.async=!0,document.querySelector("head").appendChild(f)}},this.getViewConfigByPath=function(a){var b=d[a];return _util.isEmpty(b)?b={template:a+".html"}:_util.isEmpty(b.template)&&(b.template=a+".html"),b},this.getViewPathFromHash=function(a){var b="";if(!_util.isEmpty(a)){0===a.indexOf("#")&&(a=a.substring(1));for(var c in d)0===a.indexOf(c)&&c.length>b.length&&(b=c)}return b},this.forwardTo=function(a){var b=this.getViewConfigByPath(a),c=arguments;_ui.updateHTML(this.getTemplatePath(b.template),function(){_ui.updateDocumentTitle(b.title),_util.isEmpty(b.viewModelClass)||this.loadScript(b,b.viewModelClass,function(d){if(_util.isFunction(d)){var f=d.bind.apply(d,c),g=new f;g.cache={},_log.debug("ViewModel [ "+b.viewModelClass+" ] init."),_action.doAction(g.init.bind(g)),e[a]=g}})}.bind(this))},this.backTo=function(a){var b=this.getViewConfigByPath(a);_util.isEmpty(b)?_ui.showMessage(new SystemMessage("SESYSM001E",[a]),"error"):_ui.updateHTML(this.getTemplatePath(b.template),function(){_ui.updateDocumentTitle(b.title),e[a]?e[a].init():_ui.showMessage(new SystemMessage("SESYSM001E",[a]),"error")})},this.getTemplatePath=function(a){var b="";return _util.isEmpty(a)||(b=_config.HTML_ROOT_DIR+a),b},this.getViewModelConfig=function(){return d}};