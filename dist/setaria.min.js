/**
 * Setaria v0.2.11
 * (c) 2018 Ray Han
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue-router"),require("vuex"),require("ramda"),require("axios"),require("vue")):"function"==typeof define&&define.amd?define(["exports","vue-router","vuex","ramda","axios","vue"],t):t(e.Setaria=e.Setaria||{},e.VueRouter,e.Vuex,e.R,e.axios,e.Vue)}(this,function(e,t,r,n,o,i){"use strict";function a(e,r){e.use(t),W=new t(J.routes)}function s(){return W}function u(e,t){return n.merge(e,t)}function c(e,t,r){return n.pathOr(e,t,r)}function _(e,t,r){return n.propOr(e,t,r)}function f(e){return"number"==typeof e||null!==e&&void 0!==e&&!n.isEmpty(e)}function d(e){return!f(e)}function l(e){return(J.message||{})[e]}function E(e,t){void 0===e&&(e=""),void 0===t&&(t=[]);var r=l(e),n=null===r||void 0===r?"":r;return d(n)||d(t)||t.forEach(function(e,t){var r="{"+t+"}";if(-1!==n.indexOf(r)){var o="number"==typeof e?e.toString():e;n=n.split(r).join(o)}}),n}function O(e){var t="";switch(e.charAt(e.length-1)){case"E":t="error";break;case"W":t="warning";break;case"I":default:t="info"}return t}function S(e){var t=null;try{t=e===z.LOCAL?window.localStorage:window.sessionStorage}catch(e){throw new de("SYSMSG-NOT-SUPPORT-STORAGE")}if(void 0===t)throw new de("SYSMSG-NOT-SUPPORT-STORAGE");return t}function p(e,t){S(e).setItem(le,JSON.stringify(t))}function R(e){var t=S(e);return null===t.getItem(le)&&t.setItem(le,JSON.stringify({})),JSON.parse(t.getItem(le))}function T(e){return Object.keys(z).some(function(t){return z[t]===e})}function I(e,t,r){if(T(e)){var n=R(e);n[t]=r,p(e,n)}}function h(e,t){if(T(e))return R(e)[t]}function v(e,t){if(T(e)){var r=R(e);delete r[t],p(e,r)}}function m(e){p(e,{})}function g(e,t){var r={};return f(e.scope)&&(r[me]=e.scope),f(e.modules)&&Object.keys(e.modules).forEach(function(n){N(r,t,e.modules[n],n)}),console.debug("storeSyncConfig",r),r}function N(e,t,r,n){f(r)&&(f(r.scope)&&(e[n]=r.scope),f(r.modules)&&Object.keys(r.modules).forEach(function(o){N(e,t,r.modules[o],n+"/"+o)}))}function y(e){return-1!==e.indexOf(ve)?e.substring(0,e.lastIndexOf(ve)):me}function U(e,t){var r=A(t),n=e;return 0===r.length?n:r.every(function(e){var t=n.modules;return void 0!==t&&null!==t&&(void 0!==t[e]&&null!==t[e]&&(n=t[e],!0))})?n:null}function w(e,t){return t===me?e:c(null,t.split(ve),e)}function A(e){var t=[];return-1!==e.indexOf(ve)?t=e.split(ve):e!==me&&(t=[e]),t}function G(e){return function(t){t.subscribe(function(t,r){var n=t.type;if(null!==J.store&&void 0!==J.store&&null!==J.store.modules&&void 0!==J.store.modules){var o=y(n),i=e[o];i!==z.LOCAL&&i!==z.SESSION||Ie(i,o,w(r,o))}})}}function C(e,t){e.use(r);var n=L(J.store,ue),o=g(n,J.storeScopeKey);b(o),pe(n,o),Oe=new r.Store(n)}function D(){return Oe}function b(e){ue.plugins.push(G(e))}function L(e,t){var r=e||{};return void 0!==r.modules&&null!==r.modules||(r.modules={}),Object.keys(t.modules).forEach(function(e){r.modules[e]=t.modules[e]}),void 0!==r.plugins&&null!==r.plugins||(r.plugins=[]),r.plugins=t.plugins.concat(r.plugins),r}function x(e,t){if(!x.installed||Se!==e){x.installed=!0,Se=e;var r=function(e){return void 0!==e};e.mixin({beforeCreate:function(){r(this.$options.setaria)?(this._setaria=this.$options.setaria,this.$options.store=this._setaria.getStore(),this.$options.router=this._setaria.getRouter()):this._setaria=this.$parent&&this.$parent._setaria||this},destroyed:function(){}}),null!==e.prototype.$http&&void 0!==e.prototype.$http||Object.defineProperty(e.prototype,"$http",{get:function(){return this._setaria.http}}),Object.defineProperty(e.prototype,"$s",{get:function(){return this._setaria}}),C(e,t),a(e,t)}}function M(e){var t=document.createEvent("Event");t.initEvent("unhandledrejection",!1,!0);var r={reason:{value:e,writable:!1}};Object.defineProperties(t,r),window.dispatchEvent(t)}function j(){var e=J.http||{};if(Y(e),Object.keys(e).length>0){var t=P(e);Object.keys(t).forEach(function(e){we[e]=t[e]})}return k(we),we}function Y(e){var t=e[Ue];void 0!==t&&null!==t&&Object.keys(t).forEach(function(e){o.defaults[e]=t[e]})}function P(e){if(Object.keys(e).some(function(e){return e!==Ue})){var t={};return Object.keys(e).forEach(function(r){var n=e[r];n.showLoading=!0,t[r]=o.create(n),t[r].all=o.all,t[r].spread=o.spread}),t}return null}function k(e){var t=[[V]],r=[[H,K]];"function"==typeof e?(t.forEach(function(t){var r=e.interceptors.request;r.use.apply(r,t)}),r.forEach(function(t){var r=e.interceptors.response;r.use.apply(r,t)})):Object.keys(e).forEach(function(n){t.forEach(function(t){var r=e[n].interceptors.request;r.use.apply(r,t)}),r.forEach(function(t){var r=e[n].interceptors.response;r.use.apply(r,t)})})}function V(e){var t=D();return t&&!1!==e.showLoading&&t.commit(F.ADD_LOADING_COUNT),e}function H(e){var t=D();return t&&!1!==e.config.showLoading&&t.commit(F.SUB_LOADING_COUNT),e}function K(e){if(H({config:e.config}),e.response){console.debug("server have response",e);var t="";switch(e.response.status){case 400:t="400";break;case 401:t="401";break;case 403:t="403";break;case 404:t="404";break;default:t=""}var r="SYSMSG-SERVICE-UNKNOWN-ERROR";throw""!==t&&(r="SYSMSG-SERVICE-STATUS-"+t),new ye(r,e)}if(!e.request)throw console.debug("Something happened in setting up the request that triggered an Error",e),0===e.message.indexOf("timeout of ")?new ye("SYSMSG-TIMEOUT",e,[e.config.timeout/1e3]):0===e.message.indexOf("Network Error")?new ye("SYSMSG-SERVICE-NETWORK-ERROR",e):new ye("SYSMSG-SERVICE-UNKNOWN-ERROR",e);return console.debug("The request was made but no response was received",e),Promise.reject(e)}function q(e){return"object"==typeof e&&e._name&&"ApplicationError"===e._name}function $(e){var t=null,r="",n="";if(q(e))t=new de(e.id,[],e.noIdMessage);else if(e.message){n=e.message,0===n.indexOf("Error: ")?n=n.replace("Error: ",""):0===n.indexOf("Uncaught Error: ")&&(n=n.replace("Uncaught Error: ",""));var o=n.split(fe);r=o[0].replace(_e,"").replace("[","").replace("]",""),n=o[1],t=new de(r,[],n)}else t="function"==typeof e.toString?new de(null,null,e.toString()):new de("MAM004E");return t}t="default"in t?t.default:t,r="default"in r?r.default:r,o="default"in o?o.default:o,i="default"in i?i.default:i;var W,J={errorHandler:null,message:null,http:null,routes:null,store:null,storeScopeKey:"scope"},B={_GET_IS_LOADING:"_setaria_get_is_loading",_GET_LOADING_COUNT:"_setaria_get_loading_count",_GET_ROUTE_HISTORY:"_setaria_get_route_history",_GET_ROUTE_CURRENT_INDEX:"_setaria_get_route_current_index",_GET_DIRECTION:"_setaria_get_direction"},X={_SET_DIRECTION:"_setaria_set_direction",_ADD_LOADING_COUNT:"_setaria_add_loading_count",_SUB_LOADING_COUNT:"_setaria_sub_loading_count",_UPDATE_DIRECTION:"_setaria_update_direction",_UPDATE_ROUTE_HISTORY:"_setaria_update_route_history"},F={SETARIA_STORE_MODULE:"_setaria_common_",GET_IS_LOADING:"_setaria_common_/"+B._GET_IS_LOADING,GET_LOADING_COUNT:"_setaria_common_/"+B._GET_LOADING_COUNT,GET_ROUTE_HISTORY:"_setaria_common_/"+B._GET_ROUTE_HISTORY,GET_ROUTE_CURRENT_INDEX:"_setaria_common_/"+B._GET_ROUTE_CURRENT_INDEX,GET_DIRECTION:"_setaria_common_/"+B._GET_DIRECTION,SET_DIRECTION:"_setaria_common_/"+X._SET_DIRECTION,ADD_LOADING_COUNT:"_setaria_common_/"+X._ADD_LOADING_COUNT,SUB_LOADING_COUNT:"_setaria_common_/"+X._SUB_LOADING_COUNT,UPDATE_DIRECTION:"_setaria_common_/"+X._UPDATE_DIRECTION,UPDATE_ROUTE_HISTORY:"_setaria_common_/"+X._UPDATE_ROUTE_HISTORY},z={LOCAL:"local",SESSION:"session"},Q={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},Z={NORMAL_ERROR:0,PROMISE_UNREJECT_ERROR:1,VUE_ERROR:2},ee={ERROR_TYPES:Z,MESSAGE_TYPE:Q,STORE_KEY:F,STORAGE_TYPE:z},te={_setaria_direction:"",_setaria_loading:0,_setaria_routeHistory:{currentIndex:null,history:[]}},re={};re[B._GET_ROUTE_HISTORY]=function(e){return e._setaria_routeHistory},re[B._GET_ROUTE_CURRENT_INDEX]=function(e){return e._setaria_routeHistory.currentIndex},re[B._GET_IS_LOADING]=function(e){return 0!==e._setaria_loading},re[B._GET_LOADING_COUNT]=function(e){return e._setaria_loading},re[B._GET_DIRECTION]=function(e){return e._setaria_direction};var ne={},oe={};oe[X._SET_DIRECTION]=function(e,t){e._setaria_direction=t},oe[X._ADD_LOADING_COUNT]=function(e){e._setaria_loading+=1},oe[X._SUB_LOADING_COUNT]=function(e){var t=e;t._setaria_loading>0&&(t._setaria_loading-=1)},oe[X._UPDATE_DIRECTION]=function(e,t){var r=(t.current,t.next),n=e._setaria_direction,o=e._setaria_routeHistory;if("forward"!==n&&"back"!==n){if(o.history.length>0)if(o.currentIndex===o.history.length-1)n="back";else{0!==o.currentIndex&&o.history[o.currentIndex-1]===r&&(n="back"),""===n&&o.history[o.currentIndex+1]===r&&(n="forward")}else n="forward";"forward"!==n&&"back"!==n&&(n="forward"),e._setaria_direction=n}},oe[X._UPDATE_ROUTE_HISTORY]=function(e,t){var r=t.current,n=t.next,o=e._setaria_direction,i=e._setaria_routeHistory;if("back"===o)0===i.currentIndex?i.currentIndex=null:(i.history[i.currentIndex]=r,i.currentIndex-=1);else if("forward"===o){if(null===i.currentIndex)i.currentIndex=0;else{if(i.currentIndex<i.history.length-1){var a=i.history.splice(0,i.currentIndex+1);i.history=a}i.currentIndex+=1}i.history.push(n)}};var ie,ae={},se={namespaced:!0,state:te,getters:re,actions:ne,mutations:oe,modules:ae},ue={modules:(ie={},ie._setaria_common_=se,ie),plugins:[]},ce=function(e,t,r){void 0===e&&(e=""),void 0===t&&(t=[]),void 0===r&&(r=""),this.id=e,this.type=O(e),this.params=t,this.message=E(this.id,this.params),d(this.message)&&!d(r)&&(this.message=r)};ce.prototype.getMessage=function(){return this.message},ce.prototype.toString=function(){return this.message};var _e="Setaria Error",fe=":",de=function(e){function t(t,r,n){void 0===t&&(t=""),void 0===r&&(r=[]),void 0===n&&(n="");var o=n;d(t)&&(t="unknown"),d(n)&&(o=new ce(t,r,n).getMessage());var i=_e+"["+t+"]"+fe+o;e.call(this,i),this._name="ApplicationError",this.id=t,this.params=r,this.type=Q.ERROR,this.noIdMessage=o,this.message=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),le="__Setaria_Storage_",Ee=function(){};Ee.setItem=function(e,t,r){I(e,t,r)},Ee.getItem=function(e,t){return h(e,t)},Ee.setLocalItem=function(e,t){I(z.LOCAL,e,t)},Ee.getLocalItem=function(e){return h(z.LOCAL,e)},Ee.removeLocalItem=function(e){v(z.LOCAL,e)},Ee.clearLocal=function(){m(z.LOCAL)},Ee.setSessionItem=function(e,t){I(z.SESSION,e,t)},Ee.getSessionItem=function(e){return h(z.SESSION,e)},Ee.removeSessionItem=function(e){v(z.SESSION,e)},Ee.clearSession=function(){m(z.SESSION)};var Oe,Se,pe=function(e,t){Object.keys(t).forEach(function(r){var n=t[r],o=null;o=r===me?e:U(e,r),o.state=Re(o.state,r,n)})},Re=function(e,t,r){var n={},o=he(r,t);return d(o)?e:(Object.keys(e).forEach(function(t){n[t]=_(e[t],t,o)}),n)},Te=function(e){var t=Ee.getItem(e,"__setaria_store_sync");return void 0!==t&&null!==t||(t={},Ee.setItem(e,"__setaria_store_sync",t)),t},Ie=function(e,t,r){var n=Te(e);n[t]=r,Ee.setItem(e,"__setaria_store_sync",n)},he=function(e,t){return Te(e)[t]},ve="/",me="_root",ge="undefined"!=typeof window,Ne=function(){var e=window.navigator.userAgent.toLowerCase();return"undefined"!=typeof window&&e&&/firefox\/\d+/.test(e)},ye=function(e){function t(t,r,n,o){void 0===t&&(t=""),void 0===r&&(r={}),void 0===n&&(n=[]),void 0===o&&(o=""),e.call(this,t,n,o),this._name="ApplicationError",this.type="ServiceError",this.detail=r,Ne()&&!1!==c(!0,["config","isShowError"],r)&&M(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(de),Ue="defaults",we={defaults:o},Ae=function(){};Ae.init=function(){i.config.errorHandler=function(e,t,r){console.debug("The Exception from Vue"),Ae.handleError(Z.VUE_ERROR,e,{vm:t,info:r})},window.onerror=function(e){console.debug("The Exception from window.onerror"),Ae.handleError(Z.NORMAL_ERROR,e,{})};var e=function(e){console.debug("The Exception from promise"),Ae.handleError(Z.PROMISE_UNREJECT_ERROR,e,{})};void 0!==window.unhandledrejectionHandler&&null!==window.unhandledrejectionHandler||(window.onunhandledrejection=e),window.addEventListener("unhandledrejection",e)},Ae.handleError=function(e,t,r){var n=this.parseError(e,t,r);"function"==typeof J.errorHanlder&&J.errorHanlder(n,e,t,r)},Ae.parseError=function(e,t,r){var n=null;return e===Z.VUE_ERROR?n=$(t):e===Z.NORMAL_ERROR?("string"==typeof t&&(t={message:t}),n=$(t)):n=e===Z.PROMISE_UNREJECT_ERROR?$(t.reason):new de("MAM004E"),e===Z.VUE_ERROR&&console.error(t),n};var Ge={"SYSMSG-SERVICE-UNKNOWN-ERROR":"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002","SYSMSG-TIMEOUT":"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002","SYSMSG-CLIENT-UNKNOWN-ERROR":"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002","SYSMSG-SERVICE-NETWORK-ERROR":"\u8fdc\u7a0b\u670d\u52a1\u5668\u65e0\u6cd5\u8fde\u63a5\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002","SYSMSG-NOT-SUPPORT-STORAGE":"\u5f53\u524d\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7a7a\u95f4\u3002","SYSMSG-SERVICE-STATUS-400":"\u65e0\u6548\u7684\u8bf7\u6c42\u3002","SYSMSG-SERVICE-STATUS-401":"\u5f53\u524d\u8bf7\u6c42\u9700\u8981\u7528\u6237\u9a8c\u8bc1\u3002","SYSMSG-SERVICE-STATUS-403":"\u8fdc\u7a0b\u670d\u52a1\u62d2\u7edd\u6267\u884c\u3002","SYSMSG-SERVICE-STATUS-404":"\u8bf7\u6c42\u6240\u5e0c\u671b\u5f97\u5230\u7684\u8d44\u6e90\u672a\u88ab\u5728\u670d\u52a1\u5668\u4e0a\u53d1\u73b0\u3002"},Ce=function(e){void 0===e&&(e={}),this.initConfig(e),this.initGlobalApi(),Ae.init()};Ce.prototype.initGlobalApi=function(){var e={};e.get=function(){return J},Object.defineProperty(Ce,"config",e),j()},Ce.prototype.initConfig=function(e){var t=e.message;void 0===t&&(t={});var r=e.http;void 0===r&&(r={});var n=e.routes;void 0===n&&(n={});var o=e.store;void 0===o&&(o={});var i=e.storeScopeKey;J.message=u(Ge,t),J.http=r||{},J.routes=n||{},J.store=o||{},f(i)&&(J.storeScopeKey=i)},Ce.prototype.getStore=function(){return D()},Ce.prototype.getRouter=function(){return s()},Ce.install=x,Ce.version="0.2.11",ge&&window.Vue&&window.Vue.use(Ce),e.default=Ce,e.ApplicationError=de,e.constants=ee,e.http=we,e.Message=ce,e.ServiceError=ye,Object.defineProperty(e,"__esModule",{value:!0})});