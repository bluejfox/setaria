/**
 * Setaria v0.2.6
 * (c) 2018 Ray Han
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],e):t.Setaria=e(t.Vue,t._,t.moment,null,t.axios,t.VueRouter,t.Vuex)}(this,function(t,e,r,n,i,o,a){"use strict";function s(t){}function u(){return q.message?q.message:{}}function c(){return Object.assign({},C,u())}function _(t){return c()[t]}function f(t,e){void 0===t&&(t=""),void 0===e&&(e=[]);var r=_(t),n=null===r||void 0===r?"":r;return U.isEmpty(n)||U.isEmpty(e)||e.forEach(function(t,e){var r="{"+e+"}";if(-1!==n.indexOf(r)){var i="number"==typeof t?t.toString():t;n=n.split(r).join(i)}}),n}function d(t){var e="";switch(t.charAt(t.length-1)){case"E":e="error";break;case"W":e="warning";break;case"I":default:e="info"}return e}function l(t){var e=document.createEvent("Event");e.initEvent("unhandledrejection",!1,!0);var r={reason:{value:t,writable:!1}};Object.defineProperties(e,r),window.dispatchEvent(e)}function m(t){var e=!1;return t instanceof Object&&null!==t&&void 0!==t&&null!==t.id&&void 0!==t.id?e=!0:"string"==typeof t&&(e=-1!==t.indexOf(Y)),e}function p(t){var e="",r="";if("string"==typeof t){0===t.indexOf("Error: ")?t=t.replace("Error: ",""):0===t.indexOf("Uncaught Error: ")&&(t=t.replace("Uncaught Error: ",""));var n=t.split($);return e=n[0].replace(Y,"").replace("[","").replace("]",""),r=n[1],new V(e,[],r)}return new V(t.id,[],t.noIdMessage)}function E(t){var e=null;try{e=t===X.LOCAL?window.localStorage:window.sessionStorage}catch(t){throw new V("MAM009E")}if(void 0===e)throw new V("MAM009E");return e}function v(t,e){E(t).setItem(W,JSON.stringify(e))}function h(t){var e=E(t);return null===e.getItem(W)&&e.setItem(W,JSON.stringify({})),JSON.parse(e.getItem(W))}function g(t){return Object.keys(X).some(function(e){return X[e]===t})}function y(t,e,r){if(g(t)){var n=h(t);n[e]=r,v(t,n)}}function O(t,e){if(g(t))return h(t)[e]}function I(t,e){if(g(t)){var r=h(t);delete r[e],v(t,r)}}function T(t){v(t,{})}function w(t){return Array.isArray(t)?t.map(function(t){return{key:t,val:t}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}})}function S(){return mt}function A(t,e){var r=new B("MAM001E",e);if(null!==t&&void 0!==t){var n=null;switch(t){case 404:n="404";break;default:n="001"}r=new B("MAM"+n+"E",e)}return r}function M(t,e,r,n){return void 0===n&&(n={}),new Promise(function(o,a){var s=null,u=n;t===gt.GET||t===gt.DELETE||t===gt.OPTIONS?(u.params=r,s=i[t](e,u)):s=i[t](e,r,u);var c=S();!1!==n.loading&&null!==c&&void 0!==c&&c.commit(K.ADD_LOADING_COUNT),s.then(function(t){!1!==n.loading&&null!==c&&void 0!==c&&c.commit(K.SUB_LOADING_COUNT),o(t)}).catch(function(t){!1!==n.loading&&null!==c&&void 0!==c&&c.commit(K.SUB_LOADING_COUNT);var e=new B("MAM001E",t);if(null!==t.response&&void 0!==t.response&&"number"==typeof t.response.status&&(e=A(t.response.status,t)),0===t.message.indexOf("timeout of")){var r=t.config.timeout;e=void 0===r||null===r?new B("MAM007E",t):new B("MAM003E",t,[r])}a(e)})})}function b(t){return new Promise(function(e,r){i.all(t).then(function(t){e(t)})})}function N(t){N.installed||(N.installed=!0,o.install(t),t.mixin({mounted:function(){this.$store&&this.$store.commit(K.SET_DIRECTION,"")}}))}function x(t){var e=null;try{e=require("../../../src/middleware/"+t+".js"),e&&(e=e.default)}catch(e){console.debug("\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u4e2d\u95f4\u4ef6"+t,e)}return e}function D(t,e){null!==e&&void 0!==e?t(e):t()}function R(t){var e=[];return t.forEach(function(t){U.isEmpty(t.middleware)?U.isEmpty(t.children)||(e=e.concat(R(t.children))):e.push(t)}),e}function L(t,e){var r=t.name,n=t.matched,i=e.name,o=e.path;if(!U.isEmpty(i))return r===i;if(!U.isEmpty(n)&&!U.isEmpty(o)){var a=n[n.length-1].path;if(0!==o.indexOf("/")&&(n.forEach(function(t){0===a.indexOf(t.path)&&(a=a.substring(t.path.length))}),n.length>1&&0===a.indexOf("/")&&(a=a.substring(1))),a===o)return!0}return!1}t="default"in t?t.default:t,e="default"in e?e.default:e,r="default"in r?r.default:r,i="default"in i?i.default:i,o="default"in o?o.default:o,a="default"in a?a.default:a;var C={MAM001E:"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u8bf7\u6c42\u7684\u670d\u52a1\u8bbf\u95ee\u8d85\u65f6\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002",MAM009E:"\u5f53\u524d\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7a7a\u95f4\u3002",MAM404E:"\u8bf7\u6c42\u7684\u670d\u52a1\u4e0d\u5b58\u5728\u3002"},U=function(){};U.isProdunctionEnv=function(){return!0},U.isFirefox=function(){var t=window.navigator.userAgent.toLowerCase();return"undefined"!=typeof window&&t&&/firefox\/\d+/.test(t)},U.getNow=function(t){return void 0===t&&(t="LL"),r().format(t)},U.formatDate=function(t,e){void 0===e&&(e="YYYY-MM-DD");var n="";return r(t).isValid()&&void 0!==t&&(n=r(t).format(e)),n},U.toDate=function(t){var e=t;return U.isEmpty(t)||(e=r(t).toDate()),e},U.addDateTime=function(t,e,n){return r(t).add(e,n)},U.subtractDateTime=function(t,e,n){return r(t).subtract(e,n)},U.isEmpty=function(t){return e.isEmpty(t)},U.isEqual=function(t,r){return e.isEqual(t,r)},U.isNumber=function(t){return e.isNumber(t)},U.isString=function(t){return e.isString(t)},U.isDate=function(t){return e.isDate(t)},U.isArray=function(t){return e.isArray(t)},U.isObject=function(t){return e.isObject(t)},U.isFunction=function(t){return e.isFunction(t)},U.get=function(t,r,n){return void 0===n&&(n=null),e.get(t,r,n)},U.cloneDeep=function(t){return e.cloneDeep(t)},U.getUrlParameter=function(t){var e=window.location.search.substring(1),r=e.split("&"),n=r.find(function(e){return e.split("=")[0]===t});return n=null===n||void 0===n?"":n.split("=")[1]};var k={$env:{},env:{dev:{},prod:{}},errorHanlder:null,message:{},router:{routes:[]},auth:{storageMode:"none"},storeSync:{}};try{var P=require((process.env.SETARIA_CONFIG_CONTEXT||process.cwd())+"/setaria.config.js");void 0!==P&&null!==P&&(k=Object.assign({},k,P.default)),k.message=Object.assign({},C,k.message)}catch(t){}var j=U.get(k,"env.dev",{}),G=U.get(k,"env.prod",{});U.isEmpty(j)&&U.isEmpty(G)&&!U.isEmpty(k.env)&&(G=k.env),k.$env=k.env,U.isProdunctionEnv()?k.env=Object.assign({},G):k.env=Object.assign({},G,j);var q=k,H={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},F=function(t,e,r){void 0===t&&(t=""),void 0===e&&(e=[]),void 0===r&&(r=""),this.id=t,this.type=d(t),this.params=e,this.message=f(this.id,this.params),U.isEmpty(this.message)&&!U.isEmpty(r)&&(this.message=r)};F.prototype.getMessage=function(){return this.message},F.prototype.toString=function(){return this.message};var Y="Setaria Error",$=":",V=function(t){function e(e,r,n){void 0===e&&(e=""),void 0===r&&(r=[]),void 0===n&&(n="");var i=n;U.isEmpty(e)&&(e="unknown"),U.isEmpty(n)&&(i=new F(e,r,n).getMessage());var o=Y+"["+e+"]"+$+i;t.call(this,o),this.id=e,this.params=r,this.type=H.ERROR,this.noIdMessage=i,this.message=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),B=function(t){function e(e,r,n,i){void 0===e&&(e=""),void 0===r&&(r={}),void 0===n&&(n=[]),void 0===i&&(i=""),t.call(this,e,n,i),this.type="ServiceError",this.detail=r,U.isFirefox()&&!1!==U.get(r,"config.isShowError",!0)&&l(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(V),J=function(){};J.catchError=function(){t.config.errorHandler=function(t,e){J.handleError(t,e)},window.onerror=function(t){J.handleError(t)},window.addEventListener("unhandledrejection",function(t){J.handleError(t)})},J.handleError=function(t,e){var r=this.parseError(t,e);"function"==typeof q.errorHanlder&&q.errorHanlder(r,t)},J.parseError=function(t,e){var r=null,n=e instanceof Object;if(m(t))r=p(t);else if("unhandledrejection"===t.type&&"object"==typeof t){var i=t.reason,o=i.id,a=i.message,s=i.noIdMessage,u=i.detail;r="ServiceError"===t.reason.type?t.reason:null!==s&&void 0!==s?new B(o,u,[],s):null!==a&&void 0!==a?new B("",u,[],a):new B("MAM004E",u)}else if(n&&t instanceof Error)if(U.isProdunctionEnv())r=new V("MAM004E");else{var c=t.message;r=new V("",[],c)}else r="string"==typeof t?0===t.indexOf("Uncaught Error: ")?new V("",[],t.replace("Uncaught Error: ","")):new V("",[],t):new V("MAM004E");return n&&console.error(t),r};var z="_setaria_auth_",K={MODULE_SETARIA_STORE:"_setaria_common_",GET_IS_LOADING:"_setaria_common_/_setaria_get_is_loading",GET_LOADING_COUNT:"_setaria_common_/_setaria_get_loading_count",GET_ROUTE_HISTORY:"_setaria_common_/_setaria_get_route_history",GET_ROUTE_CURRENT_INDEX:"_setaria_common_/_setaria_get_route_current_index",GET_DIRECTION:"_setaria_common_/_setaria_get_direction",SET_DIRECTION:"_setaria_common_/_setaria_set_direction",ADD_LOADING_COUNT:"_setaria_common_/_setaria_add_loading_count",SUB_LOADING_COUNT:"_setaria_common_/_setaria_sub_loading_count",UPDATE_DIRECTION:"_setaria_common_/_setaria_update_direction",UPDATE_ROUTE_HISTORY:"_setaria_common_/_setaria_update_route_history",MODULE_AUTH:z,GET_USER:"_setaria_common_/_setaria_auth_/_setaria_get_user",GET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_get_token",SET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_set_token",SET_USER:"_setaria_common_/_setaria_auth_/_setaria_set_user"},W="__Setaria_Storage_",X={LOCAL:"local",SESSION:"session"},Q=function(){};Q.setItem=function(t,e,r){y(t,e,r)},Q.getItem=function(t,e){return O(t,e)},Q.setLocalItem=function(t,e){y(X.LOCAL,t,e)},Q.getLocalItem=function(t){return O(X.LOCAL,t)},Q.removeLocalItem=function(t){I(X.LOCAL,t)},Q.clearLocal=function(){T(X.LOCAL)},Q.setSessionItem=function(t,e){y(X.SESSION,t,e)},Q.getSessionItem=function(t){return O(X.SESSION,t)},Q.removeSessionItem=function(t){I(X.SESSION,t)},Q.clearSession=function(){T(X.SESSION)};var Z=function(t,e,r,n){var i=U.get(rt(n,r),t);return void 0===i&&(i=e),i},tt=function(t){return t.replace(/\//g,".")},et=function(t,e,r){var n=rt(t,e);void 0!==n&&null!==n||(n={}),n[e]=r,Q.setItem(t,"__setaria_store_sync",n)},rt=function(t,e){var r=Q.getItem(t,"__setaria_store_sync");return void 0!==r&&null!==r||(r={},Q.setItem(t,"__setaria_store_sync",r)),r[e]};q&&(q.storeSync["_setaria_common_/_setaria_auth_"]=q.auth.storageMode);var nt=function(t,e){var r={};return w(t).forEach(function(t){var n=t.key,i=t.val,o=i;o=Z(n,i,e),r[n]=o}),r}({_setaria_token:"",_setaria_user:null},"_setaria_common_/_setaria_auth_",q.auth.storageMode),it={};it._setaria_get_user=function(t){return t._setaria_user},it._setaria_get_token=function(t){return t._setaria_token};var ot={},at={};at._setaria_set_token=function(t,e){t._setaria_token=e},at._setaria_set_user=function(t,e){t._setaria_user=e};var st={namespaced:!0,name:"_setaria_auth_",state:nt,getters:it,actions:ot,mutations:at},ut={_setaria_direction:"",_setaria_loading:0,_setaria_routeHistory:{currentIndex:null,history:[]}},ct={};ct._setaria_get_route_history=function(t){return t._setaria_routeHistory},ct._setaria_get_route_current_index=function(t){return t._setaria_routeHistory.currentIndex},ct._setaria_get_is_loading=function(t){return 0!==t._setaria_loading},ct._setaria_get_loading_count=function(t){return t._setaria_loading},ct._setaria_get_direction=function(t){return t._setaria_direction};var _t={},ft={};ft._setaria_set_direction=function(t,e){t._setaria_direction=e},ft._setaria_add_loading_count=function(t){t._setaria_loading+=1},ft._setaria_sub_loading_count=function(t){var e=t;e._setaria_loading>0&&(e._setaria_loading-=1)},ft._setaria_update_direction=function(t,e){var r=(e.current,e.next),n=t._setaria_direction,i=t._setaria_routeHistory;if("forward"!==n&&"back"!==n){if(i.history.length>0)if(i.currentIndex===i.history.length-1)n="back";else{0!==i.currentIndex&&i.history[i.currentIndex-1]===r&&(n="back"),""===n&&i.history[i.currentIndex+1]===r&&(n="forward")}else n="forward";"forward"!==n&&"back"!==n&&(n="forward"),t._setaria_direction=n}},ft._setaria_update_route_history=function(t,e){var r=e.current,n=e.next,i=t._setaria_direction,o=t._setaria_routeHistory;if("back"===i)0===o.currentIndex?o.currentIndex=null:(o.history[o.currentIndex]=r,o.currentIndex-=1);else if("forward"===i){if(null===o.currentIndex)o.currentIndex=0;else{if(o.currentIndex<o.history.length-1){var a=o.history.splice(0,o.currentIndex+1);o.history=a}o.currentIndex+=1}o.history.push(n)}};var dt={};dt[st.name]=st;var lt,mt,pt={namespaced:!0,name:"_setaria_common_",state:ut,getters:ct,actions:_t,mutations:ft,modules:dt},Et=function(t){t.subscribe(function(t,e){var r=t.type;t.payload;Object.keys(q.storeSync).forEach(function(t){if(0===r.indexOf(t)){var n=q.storeSync[t];et(n,t,U.get(e,tt(t)))}})})},vt=[Et],ht={modules:(lt={},lt[pt.name]=pt,lt),plugins:vt,strict:!1},gt={GET:"get",POST:"post",PUT:"put",DELETE:"delete",OPTIONS:"options",PATCH:"patch"},yt=function(){};yt.get=function(t,e,r){return M(gt.GET,t,e,r)},yt.post=function(t,e,r){return M(gt.POST,t,e,r)},yt.put=function(t,e,r){return M(gt.PUT,t,e,r)},yt.delete=function(t,e,r){return M(gt.DELETE,t,e,r)},yt.options=function(t,e,r){return M(gt.OPTIONS,t,e,r)},yt.patch=function(t,e,r){return M(gt.PATCH,t,e,r)},yt.all=function(t){return b(t)},yt.spread=function(t){return i.spread(t)},t.use(a);var Ot=function(t){return null!==mt&&void 0!==mt||(mt=new t(ht)),mt}(a.Store),It=function(t,e,r){var n=t.params,i=e.fullPath,o=Ot.state[K.GET_DIRECTION],a=t.fullPath;n&&"forward"===n.$$direction&&(o="forward",Ot.commit(K.SET_DIRECTION,o)),Ot.commit(K.UPDATE_DIRECTION,{current:i,next:a}),r()},Tt=function(t,e,r){var n=e.fullPath,i=t.fullPath;Ot.commit(K.UPDATE_ROUTE_HISTORY,{current:n,next:i}),r()},wt=function(t){function e(e){var r=this;void 0===e&&(e={}),t.call(this,e);var n=this;this.beforeEach(It),this.beforeEach(Tt);var i=[];if("string"==typeof e.middleware){var o=x(e.middleware);"function"==typeof o&&i.push(o)}else U.isArray(e.middleware)&&e.middleware.forEach(function(t){var e=x(t);"function"==typeof e&&i.push(e)});i.forEach(function(t){r.beforeEach(function(e,r,i){var o=t({path:e.path,query:e.query,params:e.params,name:e.name,from:r,to:e,route:n});o instanceof Promise?o.then(function(t){D(i,t)}).catch(function(t){D(i,t)}):D(i,o)})});var a=R(e.routes);U.isEmpty(a)||a.forEach(function(t){var e=x(t.middleware);U.isFunction(e)&&r.beforeEach(function(r,i,o){if(L(r,t)){var a=e({path:r.path,query:r.query,params:r.params,name:r.name,from:i,to:r,route:n});a instanceof Promise?a.then(function(t){D(o,t)}).catch(function(t){D(o,t)}):D(o,a)}else o()})}),this.afterEach(function(){Ot.commit(K.SET_DIRECTION,"")})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.forwardTo=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r={}),Ot.commit(K.SET_DIRECTION,"forward"),U.isObject(t)?this.push(t):this.push({name:t,params:e,query:r})},e.prototype.backTo=function(){t.prototype.back.call(this)},e.prototype.back=function(){Ot.commit(K.SET_DIRECTION,"back"),t.prototype.back.call(this)},e.prototype.forward=function(){Ot.commit(K.SET_DIRECTION,"forward"),t.prototype.forward.call(this)},e}(o);wt.install=N,"undefined"!=typeof window&&t.use(wt),U.isProdunctionEnv()&&(t.config.silent=!0,t.config.productionTip=!1);var St=new wt(q.router);return J.catchError(),{install:s,config:q,plugin:{router:St,store:Ot},version:"0.2.6",ApplicationError:V,ServiceError:B,Http:yt,Message:F,Storage:Q,storeTypes:K,util:U}});