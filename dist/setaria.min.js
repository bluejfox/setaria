/**
 * Setaria v0.2.3
 * (c) 2018 Ray Han
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],e):t.Setaria=e(t.Vue,t._,t.moment,null,t.axios,t.VueRouter,t.Vuex)}(this,function(t,e,r,n,i,o,a){"use strict";function s(t){}function u(){return G.message?G.message:{}}function c(){return Object.assign({},L,u())}function _(t){return c()[t]}function f(t,e){void 0===t&&(t=""),void 0===e&&(e=[]);var r=_(t),n=null===r||void 0===r?"":r;return C.isEmpty(n)||C.isEmpty(e)||e.forEach(function(t,e){var r="{"+e+"}";if(-1!==n.indexOf(r)){var i="number"==typeof t?t.toString():t;n=n.split(r).join(i)}}),n}function d(t){var e="";switch(t.charAt(t.length-1)){case"E":e="error";break;case"W":e="warning";break;case"I":default:e="info"}return e}function l(t){var e=document.createEvent("Event");e.initEvent("unhandledrejection",!1,!0);var r={reason:{value:t,writable:!1}};Object.defineProperties(e,r),window.dispatchEvent(e)}function m(t){var e=!1;return t instanceof Object&&null!==t&&void 0!==t&&null!==t.id&&void 0!==t.id?e=!0:"string"==typeof t&&(e=-1!==t.indexOf(F)),e}function p(t){var e="",r="";if("string"==typeof t){0===t.indexOf("Error: ")?t=t.replace("Error: ",""):0===t.indexOf("Uncaught Error: ")&&(t=t.replace("Uncaught Error: ",""));var n=t.split(Y);return e=n[0].replace(F,"").replace("[","").replace("]",""),r=n[1],new $(e,[],r)}return new $(t.id,[],t.noIdMessage)}function E(t){var e=null;try{e=t===W.LOCAL?window.localStorage:window.sessionStorage}catch(t){throw new $("MAM009E")}if(void 0===e)throw new $("MAM009E");return e}function v(t,e){E(t).setItem(K,JSON.stringify(e))}function h(t){var e=E(t);return null===e.getItem(K)&&e.setItem(K,JSON.stringify({})),JSON.parse(e.getItem(K))}function g(t,e,r){var n=h(t);n[e]=r,v(t,n)}function y(t,e){return h(t)[e]}function O(t,e){var r=h(t);delete r[e],v(t,r)}function I(t){v(t,{})}function T(t){return Array.isArray(t)?t.map(function(t){return{key:t,val:t}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}})}function w(){return lt}function S(t,e){var r=new V("MAM001E",e);if(null!==t&&void 0!==t){var n=null;switch(t){case 404:n="404";break;default:n="001"}r=new V("MAM"+n+"E",e)}return r}function A(t,e,r,n){return void 0===n&&(n={}),new Promise(function(o,a){var s=null,u=n;t===ht.GET||t===ht.DELETE||t===ht.OPTIONS?(u.params=r,s=i[t](e,u)):s=i[t](e,r,u);var c=w();!1!==n.loading&&null!==c&&void 0!==c&&c.commit(z.ADD_LOADING_COUNT),s.then(function(t){!1!==n.loading&&null!==c&&void 0!==c&&c.commit(z.SUB_LOADING_COUNT),o(t)}).catch(function(t){!1!==n.loading&&null!==c&&void 0!==c&&c.commit(z.SUB_LOADING_COUNT);var e=new V("MAM001E",t);if(null!==t.response&&void 0!==t.response&&"number"==typeof t.response.status&&(e=S(t.response.status,t)),0===t.message.indexOf("timeout of")){var r=t.config.timeout;e=void 0===r||null===r?new V("MAM007E",t):new V("MAM003E",t,[r])}a(e)})})}function M(t){return new Promise(function(e,r){i.all(t).then(function(t){e(t)})})}function b(t){b.installed||(b.installed=!0,o.install(t),t.mixin({mounted:function(){this.$store&&this.$store.commit(z.SET_DIRECTION,"")}}))}function N(t){var e=null;try{e=require("../../../src/middleware/"+t+".js"),e&&(e=e.default)}catch(e){console.debug("\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u4e2d\u95f4\u4ef6"+t,e)}return e}function x(t,e){null!==e&&void 0!==e?t(e):t()}function D(t){var e=[];return t.forEach(function(t){C.isEmpty(t.middleware)?C.isEmpty(t.children)||(e=e.concat(D(t.children))):e.push(t)}),e}function R(t,e){var r=t.name,n=t.matched,i=e.name,o=e.path;if(!C.isEmpty(i))return r===i;if(!C.isEmpty(n)&&!C.isEmpty(o)){var a=n[n.length-1].path;if(0!==o.indexOf("/")&&(n.forEach(function(t){0===a.indexOf(t.path)&&(a=a.substring(t.path.length))}),n.length>1&&0===a.indexOf("/")&&(a=a.substring(1))),a===o)return!0}return!1}t="default"in t?t.default:t,e="default"in e?e.default:e,r="default"in r?r.default:r,i="default"in i?i.default:i,o="default"in o?o.default:o,a="default"in a?a.default:a;var L={MAM001E:"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u8bf7\u6c42\u7684\u670d\u52a1\u8bbf\u95ee\u8d85\u65f6\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002",MAM009E:"\u5f53\u524d\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7a7a\u95f4\u3002",MAM404E:"\u8bf7\u6c42\u7684\u670d\u52a1\u4e0d\u5b58\u5728\u3002"},C=function(){};C.isProdunctionEnv=function(){return!0},C.isFirefox=function(){var t=window.navigator.userAgent.toLowerCase();return"undefined"!=typeof window&&t&&/firefox\/\d+/.test(t)},C.getNow=function(t){return void 0===t&&(t="LL"),r().format(t)},C.formatDate=function(t,e){void 0===e&&(e="YYYY-MM-DD");var n="";return r(t).isValid()&&void 0!==t&&(n=r(t).format(e)),n},C.toDate=function(t){var e=t;return C.isEmpty(t)||(e=r(t).toDate()),e},C.addDateTime=function(t,e,n){return r(t).add(e,n)},C.subtractDateTime=function(t,e,n){return r(t).subtract(e,n)},C.isEmpty=function(t){return e.isEmpty(t)},C.isEqual=function(t,r){return e.isEqual(t,r)},C.isNumber=function(t){return e.isNumber(t)},C.isString=function(t){return e.isString(t)},C.isDate=function(t){return e.isDate(t)},C.isArray=function(t){return e.isArray(t)},C.isObject=function(t){return e.isObject(t)},C.isFunction=function(t){return e.isFunction(t)},C.get=function(t,r,n){return void 0===n&&(n=null),e.get(t,r,n)},C.cloneDeep=function(t){return e.cloneDeep(t)},C.getUrlParameter=function(t){var e=window.location.search.substring(1),r=e.split("&"),n=r.find(function(e){return e.split("=")[0]===t});return n=null===n||void 0===n?"":n.split("=")[1]};var U={$env:{},env:{dev:{},prod:{}},errorHanlder:null,message:{},router:{routes:[]},auth:{storageMode:"none"},storeSync:{}};try{var P=require((process.env.SETARIA_CONFIG_CONTEXT+"/"||process.cwd())+"setaria.config.js");void 0!==P&&null!==P&&(U=Object.assign({},U,P.default)),U.message=Object.assign({},L,U.message)}catch(t){}var k=C.get(U,"env.dev",{}),j=C.get(U,"env.prod",{});C.isEmpty(k)&&C.isEmpty(j)&&!C.isEmpty(U.env)&&(j=U.env),U.$env=U.env,C.isProdunctionEnv()?U.env=Object.assign({},j):U.env=Object.assign({},j,k);var G=U,q={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},H=function(t,e,r){void 0===t&&(t=""),void 0===e&&(e=[]),void 0===r&&(r=""),this.id=t,this.type=d(t),this.params=e,this.message=f(this.id,this.params),C.isEmpty(this.message)&&!C.isEmpty(r)&&(this.message=r)};H.prototype.getMessage=function(){return this.message},H.prototype.toString=function(){return this.message};var F="Setaria Error",Y=":",$=function(t){function e(e,r,n){void 0===e&&(e=""),void 0===r&&(r=[]),void 0===n&&(n="");var i=n;C.isEmpty(e)&&(e="unknown"),C.isEmpty(n)&&(i=new H(e,r,n).getMessage());var o=F+"["+e+"]"+Y+i;t.call(this,o),this.id=e,this.params=r,this.type=q.ERROR,this.noIdMessage=i,this.message=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),V=function(t){function e(e,r,n,i){void 0===e&&(e=""),void 0===r&&(r={}),void 0===n&&(n=[]),void 0===i&&(i=""),t.call(this,e,n,i),this.type="ServiceError",this.detail=r,C.isFirefox()&&!1!==C.get(r,"config.isShowError",!0)&&l(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}($),B=function(){};B.catchError=function(){t.config.errorHandler=function(t,e){B.handleError(t,e)},window.onerror=function(t){B.handleError(t)},window.addEventListener("unhandledrejection",function(t){B.handleError(t)})},B.handleError=function(t,e){var r=this.parseError(t,e);"function"==typeof G.errorHanlder&&G.errorHanlder(r,t)},B.parseError=function(t,e){var r=null,n=e instanceof Object;if(m(t))r=p(t);else if("unhandledrejection"===t.type&&"object"==typeof t){var i=t.reason,o=i.id,a=i.message,s=i.noIdMessage,u=i.detail;r="ServiceError"===t.reason.type?t.reason:null!==s&&void 0!==s?new V(o,u,[],s):null!==a&&void 0!==a?new V("",u,[],a):new V("MAM004E",u)}else if(n&&t instanceof Error)if(C.isProdunctionEnv())r=new $("MAM004E");else{var c=t.message;r=new $("",[],c)}else r="string"==typeof t?0===t.indexOf("Uncaught Error: ")?new $("",[],t.replace("Uncaught Error: ","")):new $("",[],t):new $("MAM004E");return n&&console.error(t),r};var J="_setaria_auth_",z={MODULE_SETARIA_STORE:"_setaria_common_",GET_IS_LOADING:"_setaria_common_/_setaria_get_is_loading",GET_LOADING_COUNT:"_setaria_common_/_setaria_get_loading_count",GET_ROUTE_HISTORY:"_setaria_common_/_setaria_get_route_history",GET_ROUTE_CURRENT_INDEX:"_setaria_common_/_setaria_get_route_current_index",GET_DIRECTION:"_setaria_common_/_setaria_get_direction",SET_DIRECTION:"_setaria_common_/_setaria_set_direction",ADD_LOADING_COUNT:"_setaria_common_/_setaria_add_loading_count",SUB_LOADING_COUNT:"_setaria_common_/_setaria_sub_loading_count",UPDATE_DIRECTION:"_setaria_common_/_setaria_update_direction",UPDATE_ROUTE_HISTORY:"_setaria_common_/_setaria_update_route_history",MODULE_AUTH:J,GET_USER:"_setaria_common_/_setaria_auth_/_setaria_get_user",GET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_get_token",SET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_set_token",SET_USER:"_setaria_common_/_setaria_auth_/_setaria_set_user"},K="__Setaria_Storage_",W={LOCAL:"local",SESSION:"session"},X=function(){};X.setItem=function(t,e,r){g(t,e,r)},X.getItem=function(t,e){return y(t,e)},X.setLocalItem=function(t,e){g(W.LOCAL,t,e)},X.getLocalItem=function(t){return y(W.LOCAL,t)},X.removeLocalItem=function(t){O(W.LOCAL,t)},X.clearLocal=function(){I(W.LOCAL)},X.setSessionItem=function(t,e){g(W.SESSION,t,e)},X.getSessionItem=function(t){return y(W.SESSION,t)},X.removeSessionItem=function(t){O(W.SESSION,t)},X.clearSession=function(){I(W.SESSION)};var Q=function(t,e,r,n){var i=C.get(et(n,r),t);return void 0===i&&(i=e),i},Z=function(t){return t.replace(/\//g,".")},tt=function(t,e,r){var n=et(t,e);void 0!==n&&null!==n||(n={}),n[e]=r,X.setItem(t,"__setaria_store_sync",n)},et=function(t,e){var r=X.getItem(t,"__setaria_store_sync");return void 0!==r&&null!==r||(r={},X.setItem(t,"__setaria_store_sync",r)),r[e]};G&&(G.storeSync["_setaria_common_/_setaria_auth_"]=G.auth.storageMode);var rt=function(t,e){var r={};return T(t).forEach(function(t){var n=t.key,i=t.val,o=i;o=Q(n,i,e),r[n]=o}),r}({_setaria_token:"",_setaria_user:null},"_setaria_common_/_setaria_auth_",G.auth.storageMode),nt={};nt._setaria_get_user=function(t){return t._setaria_user},nt._setaria_get_token=function(t){return t._setaria_token};var it={},ot={};ot._setaria_set_token=function(t,e){t._setaria_token=e},ot._setaria_set_user=function(t,e){t._setaria_user=e};var at={namespaced:!0,name:"_setaria_auth_",state:rt,getters:nt,actions:it,mutations:ot},st={_setaria_direction:"",_setaria_loading:0,_setaria_routeHistory:{currentIndex:null,history:[]}},ut={};ut._setaria_get_route_history=function(t){return t._setaria_routeHistory},ut._setaria_get_route_current_index=function(t){return t._setaria_routeHistory.currentIndex},ut._setaria_get_is_loading=function(t){return 0!==t._setaria_loading},ut._setaria_get_loading_count=function(t){return t._setaria_loading},ut._setaria_get_direction=function(t){return t._setaria_direction};var ct={},_t={};_t._setaria_set_direction=function(t,e){t._setaria_direction=e},_t._setaria_add_loading_count=function(t){t._setaria_loading+=1},_t._setaria_sub_loading_count=function(t){var e=t;e._setaria_loading>0&&(e._setaria_loading-=1)},_t._setaria_update_direction=function(t,e){var r=(e.current,e.next),n=t._setaria_direction,i=t._setaria_routeHistory;if("forward"!==n&&"back"!==n){if(i.history.length>0)if(i.currentIndex===i.history.length-1)n="back";else{0!==i.currentIndex&&i.history[i.currentIndex-1]===r&&(n="back"),""===n&&i.history[i.currentIndex+1]===r&&(n="forward")}else n="forward";"forward"!==n&&"back"!==n&&(n="forward"),t._setaria_direction=n}},_t._setaria_update_route_history=function(t,e){var r=e.current,n=e.next,i=t._setaria_direction,o=t._setaria_routeHistory;if("back"===i)0===o.currentIndex?o.currentIndex=null:(o.history[o.currentIndex]=r,o.currentIndex-=1);else if("forward"===i){if(null===o.currentIndex)o.currentIndex=0;else{if(o.currentIndex<o.history.length-1){var a=o.history.splice(0,o.currentIndex+1);o.history=a}o.currentIndex+=1}o.history.push(n)}};var ft={};ft[at.name]=at;var dt,lt,mt={namespaced:!0,name:"_setaria_common_",state:st,getters:ut,actions:ct,mutations:_t,modules:ft},pt=function(t){t.subscribe(function(t,e){var r=t.type;t.payload;Object.keys(G.storeSync).forEach(function(t){if(0===r.indexOf(t)){var n=G.storeSync[t];tt(n,t,C.get(e,Z(t)))}})})},Et=[pt],vt={modules:(dt={},dt[mt.name]=mt,dt),plugins:Et,strict:!1},ht={GET:"get",POST:"post",PUT:"put",DELETE:"delete",OPTIONS:"options",PATCH:"patch"},gt=function(){};gt.get=function(t,e,r){return A(ht.GET,t,e,r)},gt.post=function(t,e,r){return A(ht.POST,t,e,r)},gt.put=function(t,e,r){return A(ht.PUT,t,e,r)},gt.delete=function(t,e,r){return A(ht.DELETE,t,e,r)},gt.options=function(t,e,r){return A(ht.OPTIONS,t,e,r)},gt.patch=function(t,e,r){return A(ht.PATCH,t,e,r)},gt.all=function(t){return M(t)},gt.spread=function(t){return i.spread(t)},t.use(a);var yt=function(t){return null!==lt&&void 0!==lt||(lt=new t(vt)),lt}(a.Store),Ot=function(t,e,r){var n=t.params,i=e.fullPath,o=yt.state[z.GET_DIRECTION],a=t.fullPath;n&&"forward"===n.$$direction&&(o="forward",yt.commit(z.SET_DIRECTION,o)),yt.commit(z.UPDATE_DIRECTION,{current:i,next:a}),r()},It=function(t,e,r){var n=e.fullPath,i=t.fullPath;yt.commit(z.UPDATE_ROUTE_HISTORY,{current:n,next:i}),r()},Tt=function(t){function e(e){var r=this;void 0===e&&(e={}),t.call(this,e);var n=this;this.beforeEach(Ot),this.beforeEach(It);var i=[];if("string"==typeof e.middleware){var o=N(e.middleware);"function"==typeof o&&i.push(o)}else C.isArray(e.middleware)&&e.middleware.forEach(function(t){var e=N(t);"function"==typeof e&&i.push(e)});i.forEach(function(t){r.beforeEach(function(e,r,i){var o=t({path:e.path,query:e.query,params:e.params,name:e.name,from:r,to:e,route:n});o instanceof Promise?o.then(function(t){x(i,t)}).catch(function(t){x(i,t)}):x(i,o)})});var a=D(e.routes);C.isEmpty(a)||a.forEach(function(t){var e=N(t.middleware);C.isFunction(e)&&r.beforeEach(function(r,i,o){if(R(r,t)){var a=e({path:r.path,query:r.query,params:r.params,name:r.name,from:i,to:r,route:n});a instanceof Promise?a.then(function(t){x(o,t)}).catch(function(t){x(o,t)}):x(o,a)}else o()})}),this.afterEach(function(){yt.commit(z.SET_DIRECTION,"")})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.forwardTo=function(t,e,r){void 0===e&&(e={}),void 0===r&&(r={}),yt.commit(z.SET_DIRECTION,"forward"),C.isObject(t)?this.push(t):this.push({name:t,params:e,query:r})},e.prototype.backTo=function(){t.prototype.back.call(this)},e.prototype.back=function(){yt.commit(z.SET_DIRECTION,"back"),t.prototype.back.call(this)},e.prototype.forward=function(){yt.commit(z.SET_DIRECTION,"forward"),t.prototype.forward.call(this)},e}(o);Tt.install=b,"undefined"!=typeof window&&t.use(Tt),C.isProdunctionEnv()&&(t.config.silent=!0,t.config.productionTip=!1);var wt=new Tt(G.router);return B.catchError(),{install:s,config:G,plugin:{router:wt,store:yt},version:"0.2.3",ApplicationError:$,ServiceError:V,Http:gt,Message:H,Storage:X,storeTypes:z,util:C}});