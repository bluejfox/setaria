/**
 * Setaria v0.2.9
 * (c) 2018 Ray Han
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],e):t.Setaria=e(t.Vue,t._,t.moment,null,t.axios,t.VueRouter,t.Vuex)}(this,function(t,e,n,r,i,o,a){"use strict";function s(t){}function u(){return q.message?q.message:{}}function c(){return Object.assign({},C,u())}function _(t){return c()[t]}function f(t,e){void 0===t&&(t=""),void 0===e&&(e=[]);var n=_(t),r=null===n||void 0===n?"":n;return P.isEmpty(r)||P.isEmpty(e)||e.forEach(function(t,e){var n="{"+e+"}";if(-1!==r.indexOf(n)){var i="number"==typeof t?t.toString():t;r=r.split(n).join(i)}}),r}function d(t){var e="";switch(t.charAt(t.length-1)){case"E":e="error";break;case"W":e="warning";break;case"I":default:e="info"}return e}function l(t){return"object"==typeof t&&t._name&&"ApplicationError"===t._name}function m(t){var e=null,n="",r="";if(l(t))e=new $(t.id,[],t.noIdMessage);else if(t.message){r=t.message,0===r.indexOf("Error: ")?r=r.replace("Error: ",""):0===r.indexOf("Uncaught Error: ")&&(r=r.replace("Uncaught Error: ",""));var i=r.split(J);n=i[0].replace(Y,"").replace("[","").replace("]",""),r=i[1],e=new $(n,[],r)}else e="function"==typeof t.toString?new $(null,null,t.toString()):new $("MAM004E");return e}function E(t){var e=document.createEvent("Event");e.initEvent("unhandledrejection",!1,!0);var n={reason:{value:t,writable:!1}};Object.defineProperties(e,n),window.dispatchEvent(e)}function p(t){var e=null;try{e=t===tt.LOCAL?window.localStorage:window.sessionStorage}catch(t){throw new $("MAM009E")}if(void 0===e)throw new $("MAM009E");return e}function v(t,e){p(t).setItem(Z,JSON.stringify(e))}function h(t){var e=p(t);return null===e.getItem(Z)&&e.setItem(Z,JSON.stringify({})),JSON.parse(e.getItem(Z))}function g(t){return Object.keys(tt).some(function(e){return tt[e]===t})}function y(t,e,n){if(g(t)){var r=h(t);r[e]=n,v(t,r)}}function O(t,e){if(g(t))return h(t)[e]}function I(t,e){if(g(t)){var n=h(t);delete n[e],v(t,n)}}function T(t){v(t,{})}function w(t){return Array.isArray(t)?t.map(function(t){return{key:t,val:t}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}})}function R(){return gt}function S(t,e,n){var r=e;n&&(r.state=rt(r.state,t,n),W.sync[t]=n),gt.registerModule(t,e)}function A(t,e){var n=new K("MAM001E",e);if(null!==t&&void 0!==t){var r=null;switch(t){case 404:r="404";break;default:r="001"}n=new K("MAM"+r+"E",e)}return n}function M(t,e,n,r){return void 0===r&&(r={}),new Promise(function(o,a){var s=null,u=r;t===wt.GET||t===wt.DELETE||t===wt.OPTIONS?(u.params=n,s=i[t](e,u)):s=i[t](e,n,u);var c=R();!1!==r.loading&&null!==c&&void 0!==c&&c.commit(Q.ADD_LOADING_COUNT),s.then(function(t){!1!==r.loading&&null!==c&&void 0!==c&&c.commit(Q.SUB_LOADING_COUNT),o(t)}).catch(function(t){!1!==r.loading&&null!==c&&void 0!==c&&c.commit(Q.SUB_LOADING_COUNT);var e=new K("MAM001E",t);if(null!==t.response&&void 0!==t.response&&"number"==typeof t.response.status&&(e=A(t.response.status,t)),0===t.message.indexOf("timeout of")){var n=t.config.timeout;e=void 0===n||null===n?new K("MAM007E",t):new K("MAM003E",t,[n])}a(e)})})}function N(t){return new Promise(function(e,n){i.all(t).then(function(t){e(t)})})}function b(t){b.installed||(b.installed=!0,o.install(t),t.mixin({mounted:function(){this.$store&&this.$store.commit(Q.SET_DIRECTION,"")}}))}function D(t){var e=null;try{e=require("../../../src/middleware/"+t+".js"),e&&(e=e.default)}catch(e){console.debug("\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u4e2d\u95f4\u4ef6"+t,e)}return e}function x(t,e){null!==e&&void 0!==e?t(e):t()}function U(t){var e=[];return t.forEach(function(t){P.isEmpty(t.middleware)?P.isEmpty(t.children)||(e=e.concat(U(t.children))):e.push(t)}),e}function L(t,e){var n=t.name,r=t.matched,i=e.name,o=e.path;if(!P.isEmpty(i))return n===i;if(!P.isEmpty(r)&&!P.isEmpty(o)){var a=r[r.length-1].path;if(0!==o.indexOf("/")&&(r.forEach(function(t){0===a.indexOf(t.path)&&(a=a.substring(t.path.length))}),r.length>1&&0===a.indexOf("/")&&(a=a.substring(1))),a===o)return!0}return!1}t="default"in t?t.default:t,e="default"in e?e.default:e,n="default"in n?n.default:n,i="default"in i?i.default:i,o="default"in o?o.default:o,a="default"in a?a.default:a;var C={MAM001E:"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u8bf7\u6c42\u7684\u670d\u52a1\u8bbf\u95ee\u8d85\u65f6\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002",MAM009E:"\u5f53\u524d\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7a7a\u95f4\u3002",MAM404E:"\u8bf7\u6c42\u7684\u670d\u52a1\u4e0d\u5b58\u5728\u3002"},P=function(){};P.isProdunctionEnv=function(){return!0},P.isFirefox=function(){var t=window.navigator.userAgent.toLowerCase();return"undefined"!=typeof window&&t&&/firefox\/\d+/.test(t)},P.getNow=function(t){return void 0===t&&(t="LL"),n().format(t)},P.formatDate=function(t,e){void 0===e&&(e="YYYY-MM-DD");var r="";return n(t).isValid()&&void 0!==t&&(r=n(t).format(e)),r},P.toDate=function(t){var e=t;return P.isEmpty(t)||(e=n(t).toDate()),e},P.addDateTime=function(t,e,r){return n(t).add(e,r)},P.subtractDateTime=function(t,e,r){return n(t).subtract(e,r)},P.isEmpty=function(t){return e.isEmpty(t)},P.isEqual=function(t,n){return e.isEqual(t,n)},P.isNumber=function(t){return e.isNumber(t)},P.isString=function(t){return e.isString(t)},P.isDate=function(t){return e.isDate(t)},P.isArray=function(t){return e.isArray(t)},P.isObject=function(t){return e.isObject(t)},P.isFunction=function(t){return e.isFunction(t)},P.get=function(t,n,r){return void 0===r&&(r=null),e.get(t,n,r)},P.cloneDeep=function(t){return e.cloneDeep(t)},P.getUrlParameter=function(t){var e=window.location.search.substring(1),n=e.split("&"),r=n.find(function(e){return e.split("=")[0]===t});return r=null===r||void 0===r?"":r.split("=")[1]};var k={$env:{},env:{dev:{},prod:{}},errorHanlder:null,message:{},router:{routes:[]},auth:{storageMode:"none"},storeSync:{}};try{var j=require((process.env.SETARIA_CONFIG_CONTEXT||process.cwd())+"/setaria.config.js");void 0!==j&&null!==j&&(k=Object.assign({},k,j.default)),k.message=Object.assign({},C,k.message)}catch(t){}var G=P.get(k,"env.dev",{}),H=P.get(k,"env.prod",{});P.isEmpty(G)&&P.isEmpty(H)&&!P.isEmpty(k.env)&&(H=k.env),k.$env=k.env,P.isProdunctionEnv()?k.env=Object.assign({},H):k.env=Object.assign({},H,G);var q=k,V={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},F=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=[]),void 0===n&&(n=""),this.id=t,this.type=d(t),this.params=e,this.message=f(this.id,this.params),P.isEmpty(this.message)&&!P.isEmpty(n)&&(this.message=n)};F.prototype.getMessage=function(){return this.message},F.prototype.toString=function(){return this.message};var Y="Setaria Error",J=":",$=function(t){function e(e,n,r){void 0===e&&(e=""),void 0===n&&(n=[]),void 0===r&&(r="");var i=r;P.isEmpty(e)&&(e="unknown"),P.isEmpty(r)&&(i=new F(e,n,r).getMessage());var o=Y+"["+e+"]"+J+i;t.call(this,o),this._name="ApplicationError",this.id=e,this.params=n,this.type=V.ERROR,this.noIdMessage=i,this.message=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),B={NORMAL_ERROR:0,PROMISE_UNREJECT_ERROR:1,VUE_ERROR:2},z=function(){};z.catchError=function(){t.config.errorHandler=function(t,e,n){z.handleError(B.VUE_ERROR,t,{vm:e,info:n})},window.onerror=function(t){z.handleError(B.NORMAL_ERROR,t,{})};var e=function(t){z.handleError(B.PROMISE_UNREJECT_ERROR,t,{})};void 0!==window.unhandledrejectionHandler&&null!==window.unhandledrejectionHandler||(window.onunhandledrejection=e),window.addEventListener("unhandledrejection",e)},z.handleError=function(t,e,n){var r=this.parseError(t,e,n);"function"==typeof q.errorHanlder&&q.errorHanlder(r,t,e,n)},z.parseError=function(t,e,n){var r=null;return r=l(e)||t===B.NORMAL_ERROR||t===B.VUE_ERROR?m(e):t===B.PROMISE_UNREJECT_ERROR?m(e.reason):"string"==typeof e?0===e.indexOf("Uncaught Error: ")?new $("",[],e.replace("Uncaught Error: ","")):new $("",[],e):new $("MAM004E"),t===B.VUE_ERROR&&console.error(e),r};var K=function(t){function e(e,n,r,i){void 0===e&&(e=""),void 0===n&&(n={}),void 0===r&&(r=[]),void 0===i&&(i=""),t.call(this,e,r,i),this._name="ApplicationError",this.type="ServiceError",this.detail=n,P.isFirefox()&&!1!==P.get(n,"config.isShowError",!0)&&E(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}($),W={sync:{}},X="_setaria_auth_",Q={MODULE_SETARIA_STORE:"_setaria_common_",GET_IS_LOADING:"_setaria_common_/_setaria_get_is_loading",GET_LOADING_COUNT:"_setaria_common_/_setaria_get_loading_count",GET_ROUTE_HISTORY:"_setaria_common_/_setaria_get_route_history",GET_ROUTE_CURRENT_INDEX:"_setaria_common_/_setaria_get_route_current_index",GET_DIRECTION:"_setaria_common_/_setaria_get_direction",SET_DIRECTION:"_setaria_common_/_setaria_set_direction",ADD_LOADING_COUNT:"_setaria_common_/_setaria_add_loading_count",SUB_LOADING_COUNT:"_setaria_common_/_setaria_sub_loading_count",UPDATE_DIRECTION:"_setaria_common_/_setaria_update_direction",UPDATE_ROUTE_HISTORY:"_setaria_common_/_setaria_update_route_history",MODULE_AUTH:X,GET_USER:"_setaria_common_/_setaria_auth_/_setaria_get_user",GET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_get_token",SET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_set_token",SET_USER:"_setaria_common_/_setaria_auth_/_setaria_set_user"},Z="__Setaria_Storage_",tt={LOCAL:"local",SESSION:"session"},et=function(){};et.setItem=function(t,e,n){y(t,e,n)},et.getItem=function(t,e){return O(t,e)},et.setLocalItem=function(t,e){y(tt.LOCAL,t,e)},et.getLocalItem=function(t){return O(tt.LOCAL,t)},et.removeLocalItem=function(t){I(tt.LOCAL,t)},et.clearLocal=function(){T(tt.LOCAL)},et.setSessionItem=function(t,e){y(tt.SESSION,t,e)},et.getSessionItem=function(t){return O(tt.SESSION,t)},et.removeSessionItem=function(t){I(tt.SESSION,t)},et.clearSession=function(){T(tt.SESSION)};var nt=function(t,e,n,r){var i=P.get(st(r,n),t);return void 0===i&&(i=e),i},rt=function(t,e,n){var r={};return w(t).forEach(function(t){var i=t.key,o=t.val,a=o;a=nt(i,o,e,n),r[i]=a}),r},it=function(t){return t.replace(/\//g,".")},ot=function(t){var e=et.getItem(t,"__setaria_store_sync");return void 0!==e&&null!==e||(e={},et.setItem(t,"__setaria_store_sync",e)),e},at=function(t,e,n){var r=ot(t),i=P.get(r,e);P.isEmpty(i)&&(i={}),Object.assign(i,n),r[e]=i,et.setItem(t,"__setaria_store_sync",r)},st=function(t,e){return ot(t)[e]};q&&(W.sync["_setaria_common_/_setaria_auth_"]=q.auth.storageMode);var ut=rt({_setaria_token:"",_setaria_user:null},"_setaria_common_/_setaria_auth_",q.auth.storageMode),ct={};ct._setaria_get_user=function(t){return t._setaria_user},ct._setaria_get_token=function(t){return t._setaria_token};var _t={},ft={};ft._setaria_set_token=function(t,e){t._setaria_token=e},ft._setaria_set_user=function(t,e){t._setaria_user=e};var dt={namespaced:!0,name:"_setaria_auth_",state:ut,getters:ct,actions:_t,mutations:ft},lt={_setaria_direction:"",_setaria_loading:0,_setaria_routeHistory:{currentIndex:null,history:[]}},mt={};mt._setaria_get_route_history=function(t){return t._setaria_routeHistory},mt._setaria_get_route_current_index=function(t){return t._setaria_routeHistory.currentIndex},mt._setaria_get_is_loading=function(t){return 0!==t._setaria_loading},mt._setaria_get_loading_count=function(t){return t._setaria_loading},mt._setaria_get_direction=function(t){return t._setaria_direction};var Et={},pt={};pt._setaria_set_direction=function(t,e){t._setaria_direction=e},pt._setaria_add_loading_count=function(t){t._setaria_loading+=1},pt._setaria_sub_loading_count=function(t){var e=t;e._setaria_loading>0&&(e._setaria_loading-=1)},pt._setaria_update_direction=function(t,e){var n=(e.current,e.next),r=t._setaria_direction,i=t._setaria_routeHistory;if("forward"!==r&&"back"!==r){if(i.history.length>0)if(i.currentIndex===i.history.length-1)r="back";else{0!==i.currentIndex&&i.history[i.currentIndex-1]===n&&(r="back"),""===r&&i.history[i.currentIndex+1]===n&&(r="forward")}else r="forward";"forward"!==r&&"back"!==r&&(r="forward"),t._setaria_direction=r}},pt._setaria_update_route_history=function(t,e){var n=e.current,r=e.next,i=t._setaria_direction,o=t._setaria_routeHistory;if("back"===i)0===o.currentIndex?o.currentIndex=null:(o.history[o.currentIndex]=n,o.currentIndex-=1);else if("forward"===i){if(null===o.currentIndex)o.currentIndex=0;else{if(o.currentIndex<o.history.length-1){var a=o.history.splice(0,o.currentIndex+1);o.history=a}o.currentIndex+=1}o.history.push(r)}};var vt={};vt[dt.name]=dt;var ht,gt,yt={namespaced:!0,name:"_setaria_common_",state:lt,getters:mt,actions:Et,mutations:pt,modules:vt},Ot=function(t){t.subscribe(function(t,e){var n=t.type;t.payload;Object.keys(W.sync).forEach(function(t){if(0===n.indexOf(t)){var r=W.sync[t];at(r,t,P.get(e,it(t)))}})})},It=[Ot],Tt={modules:(ht={},ht[yt.name]=yt,ht),plugins:It,strict:!1},wt={GET:"get",POST:"post",PUT:"put",DELETE:"delete",OPTIONS:"options",PATCH:"patch"},Rt=function(){};Rt.get=function(t,e,n){return M(wt.GET,t,e,n)},Rt.post=function(t,e,n){return M(wt.POST,t,e,n)},Rt.put=function(t,e,n){return M(wt.PUT,t,e,n)},Rt.delete=function(t,e,n){return M(wt.DELETE,t,e,n)},Rt.options=function(t,e,n){return M(wt.OPTIONS,t,e,n)},Rt.patch=function(t,e,n){return M(wt.PATCH,t,e,n)},Rt.all=function(t){return N(t)},Rt.spread=function(t){return i.spread(t)},t.use(a);var St=function(t){return null!==gt&&void 0!==gt||(gt=new t(Tt)),gt}(a.Store),At=function(t,e,n){var r=t.params,i=e.fullPath,o=St.state[Q.GET_DIRECTION],a=t.fullPath;r&&"forward"===r.$$direction&&(o="forward",St.commit(Q.SET_DIRECTION,o)),St.commit(Q.UPDATE_DIRECTION,{current:i,next:a}),n()},Mt=function(t,e,n){var r=e.fullPath,i=t.fullPath;St.commit(Q.UPDATE_ROUTE_HISTORY,{current:r,next:i}),n()},Nt=function(t){function e(e){var n=this;void 0===e&&(e={}),t.call(this,e);var r=this;this.beforeEach(At),this.beforeEach(Mt);var i=[];if("string"==typeof e.middleware){var o=D(e.middleware);"function"==typeof o&&i.push(o)}else P.isArray(e.middleware)&&e.middleware.forEach(function(t){var e=D(t);"function"==typeof e&&i.push(e)});i.forEach(function(t){n.beforeEach(function(e,n,i){var o=t({path:e.path,query:e.query,params:e.params,name:e.name,from:n,to:e,route:r});o instanceof Promise?o.then(function(t){x(i,t)}).catch(function(t){x(i,t)}):x(i,o)})});var a=U(e.routes);P.isEmpty(a)||a.forEach(function(t){var e=D(t.middleware);P.isFunction(e)&&n.beforeEach(function(n,i,o){if(L(n,t)){var a=e({path:n.path,query:n.query,params:n.params,name:n.name,from:i,to:n,route:r});a instanceof Promise?a.then(function(t){x(o,t)}).catch(function(t){x(o,t)}):x(o,a)}else o()})}),this.afterEach(function(){St.commit(Q.SET_DIRECTION,"")})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.forwardTo=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n={}),St.commit(Q.SET_DIRECTION,"forward"),P.isObject(t)?this.push(t):this.push({name:t,params:e,query:n})},e.prototype.backTo=function(){t.prototype.back.call(this)},e.prototype.back=function(){St.commit(Q.SET_DIRECTION,"back"),t.prototype.back.call(this)},e.prototype.forward=function(){St.commit(Q.SET_DIRECTION,"forward"),t.prototype.forward.call(this)},e}(o);Nt.install=b,"undefined"!=typeof window&&t.use(Nt),P.isProdunctionEnv()&&(t.config.silent=!0,t.config.productionTip=!1);var bt=new Nt(q.router);return z.catchError(),{ApplicationError:$,Http:Rt,Message:F,ServiceError:K,Storage:et,storageTypes:tt,config:q,install:s,plugin:{router:bt,store:St},router:bt,store:St,storeRegister:S,storeTypes:Q,util:P,version:"0.2.9"}});