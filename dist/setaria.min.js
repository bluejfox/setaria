/**
 * Setaria v0.3.2
 * (c) 2018 Ray Han
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios"),require("vuex"),require("ramda"),require("vue-router"),require("vue")):"function"==typeof define&&define.amd?define(["exports","axios","vuex","ramda","vue-router","vue"],t):t(e.Setaria=e.Setaria||{},e.axios,e.Vuex,e.R,e.VueRouter,e.Vue)}(this,function(e,t,n,r,o,i){"use strict";function a(e,t){return r.merge(e,t)}function s(e,t,n){return r.pathOr(e,t,n)}function u(e,t,n){return r.propOr(e,t,n)}function c(e){return"number"==typeof e||null!==e&&void 0!==e&&!r.isEmpty(e)}function _(e){return!c(e)}function f(e){return(B.message||{})[e]}function d(e,t){void 0===e&&(e=""),void 0===t&&(t=[]);var n=f(e),r=null===n||void 0===n?"":n;return _(r)||_(t)||t.forEach(function(e,t){var n="{"+t+"}";if(-1!==r.indexOf(n)){var o="number"==typeof e?e.toString():e;r=r.split(n).join(o)}}),r}function l(e){var t="";switch(e.charAt(e.length-1)){case"E":t="error";break;case"W":t="warning";break;case"I":default:t="info"}return t}function E(e){var t=null;try{t=e===Q.LOCAL?window.localStorage:window.sessionStorage}catch(e){throw new le("SYSMSG-NOT-SUPPORT-STORAGE")}if(void 0===t)throw new le("SYSMSG-NOT-SUPPORT-STORAGE");return t}function S(e,t){E(e).setItem(Ee,JSON.stringify(t))}function O(e){var t=E(e);return null===t.getItem(Ee)&&t.setItem(Ee,JSON.stringify({})),JSON.parse(t.getItem(Ee))}function p(e){return Object.keys(Q).some(function(t){return Q[t]===e})}function R(e,t,n){if(p(e)){var r=O(e);r[t]=n,S(e,r)}}function T(e,t){if(p(e))return O(e)[t]}function v(e,t){if(p(e)){var n=O(e);delete n[t],S(e,n)}}function I(e){S(e,{})}function h(e,t){var n={};return c(e.scope)&&(n[ye]=e.scope),c(e.modules)&&Object.keys(e.modules).forEach(function(r){g(n,t,e.modules[r],r)}),console.debug("storeSyncConfig",n),n}function g(e,t,n,r){c(n)&&(c(n.scope)&&(e[r]=n.scope),c(n.modules)&&Object.keys(n.modules).forEach(function(o){g(e,t,n.modules[o],r+"/"+o)}))}function m(e){return-1!==e.indexOf(Ne)?e.substring(0,e.lastIndexOf(Ne)):ye}function N(e,t){var n=U(t),r=e;return 0===n.length?r:n.every(function(e){var t=r.modules;return void 0!==t&&null!==t&&(void 0!==t[e]&&null!==t[e]&&(r=t[e],!0))})?r:null}function y(e,t){return t===ye?e:s(null,t.split(Ne),e)}function U(e){var t=[];return-1!==e.indexOf(Ne)?t=e.split(Ne):e!==ye&&(t=[e]),t}function w(e){return function(t){t.subscribe(function(t,n){var r=t.type;if(null!==B.store&&void 0!==B.store&&null!==B.store.modules&&void 0!==B.store.modules){var o=m(r),i=e[o];i!==Q.LOCAL&&i!==Q.SESSION||ge(i,o,y(n,o))}})}}function A(e,t){e.use(n);var r=D(B.store,ce),o=h(r,B.storeScopeKey);C(r,o),ve(r,o),Oe=new n.Store(r)}function G(){return Oe}function C(e,t){e.plugins.push(w(t))}function D(e,t){var n=e||{};return void 0!==n.modules&&null!==n.modules||(n.modules={}),Object.keys(t.modules).forEach(function(e){n.modules[e]=t.modules[e]}),void 0!==n.plugins&&null!==n.plugins||(n.plugins=[]),n.plugins=t.plugins.concat(n.plugins),n}function b(e){var t=G();return t&&!1!==e.showLoading&&t.commit(z.ADD_LOADING_COUNT),e}function L(e){var t=G();return t&&!1!==e.config.showLoading&&t.commit(z.SUB_LOADING_COUNT),e}function x(e){var t=document.createEvent("Event");t.initEvent("unhandledrejection",!1,!0);var n={reason:{value:e,writable:!1}};Object.defineProperties(t,n),window.dispatchEvent(t)}function M(e){if(L({config:e.config}),e.response){console.debug("server have response",e);var t="";switch(e.response.status){case 400:t="400";break;case 401:t="401";break;case 403:t="403";break;case 404:t="404";break;default:t=""}var n="SYSMSG-SERVICE-UNKNOWN-ERROR";throw""!==t&&(n="SYSMSG-SERVICE-STATUS-"+t),new Ae(n,e)}if(!e.request)throw console.debug("Something happened in setting up the request that triggered an Error",e),0===e.message.indexOf("timeout of ")?new Ae("SYSMSG-TIMEOUT",e,[e.config.timeout/1e3]):0===e.message.indexOf("Network Error")?new Ae("SYSMSG-SERVICE-NETWORK-ERROR",e):new Ae("SYSMSG-SERVICE-UNKNOWN-ERROR",e);return console.debug("The request was made but no response was received",e),Promise.reject(e)}function Y(e,n){pe={defaults:t};var r=B.http||{};if(k(r),Object.keys(r).length>0){var o=P(r);Object.keys(o).forEach(function(e){pe[e]=o[e]})}H(pe)}function j(){return pe}function k(e){var n=e[Ge];void 0!==n&&null!==n&&Object.keys(n).forEach(function(e){t.defaults[e]=n[e]})}function P(e){if(Object.keys(e).some(function(e){return e!==Ge})){var n={};return Object.keys(e).forEach(function(r){var o=e[r];o.showLoading=!0,n[r]=t.create(o),n[r].all=t.all,n[r].spread=t.spread}),n}return{}}function H(e){var t=[[b]],n=[[L,M]];"function"==typeof e?(t.forEach(function(t){var n=e.interceptors.request;n.use.apply(n,t)}),n.forEach(function(t){var n=e.interceptors.response;n.use.apply(n,t)})):Object.keys(e).forEach(function(r){t.forEach(function(t){var n=e[r].interceptors.request;n.use.apply(n,t)}),n.forEach(function(t){var n=e[r].interceptors.response;n.use.apply(n,t)})})}function V(e,t){e.use(o),Re=new o(B.routes)}function K(){return Re}function q(e,t,n){return function(t,n){if(!q.installed||Te!==t){q.installed=!0,Te=t;var r=function(e){return void 0!==e};t.mixin({beforeCreate:function(){r(this.$options.setaria)?(this._setaria=this.$options.setaria,this.$options.store=e.getStore(),this.$options.router=e.getRouter()):this._setaria=this.$parent&&this.$parent._setaria||this},destroyed:function(){}}),null!==t.prototype.$http&&void 0!==t.prototype.$http||Object.defineProperty(t.prototype,"$http",{get:function(){return e.getHttp()}}),Y(t,n),A(t,n),V(t,n)}}}function $(e){return"object"==typeof e&&e._name&&"ApplicationError"===e._name}function W(e){var t=null,n="",r="";if($(e))t=new le(e.id,[],e.noIdMessage);else if(e.message){r=e.message,0===r.indexOf("Error: ")?r=r.replace("Error: ",""):0===r.indexOf("Uncaught Error: ")&&(r=r.replace("Uncaught Error: ",""));var o=r.split(de);n=o[0].replace(fe,"").replace("[","").replace("]",""),r=o[1],t=new le(n,[],r)}else t="function"==typeof e.toString?new le(null,null,e.toString()):new le("MAM004E");return t}function J(e,t){var n={};n.get=function(){return B},Object.defineProperty(e,"config",n),e.getHttp=j,e.getRouter=K,e.getStore=G,t.http=j(),t.router=K(),t.store=G()}t="default"in t?t.default:t,n="default"in n?n.default:n,o="default"in o?o.default:o,i="default"in i?i.default:i;var B={errorHandler:null,message:null,http:null,routes:null,store:null,storeScopeKey:"scope"},X={_GET_IS_LOADING:"_setaria_get_is_loading",_GET_LOADING_COUNT:"_setaria_get_loading_count",_GET_ROUTE_HISTORY:"_setaria_get_route_history",_GET_ROUTE_CURRENT_INDEX:"_setaria_get_route_current_index",_GET_DIRECTION:"_setaria_get_direction"},F={_SET_DIRECTION:"_setaria_set_direction",_ADD_LOADING_COUNT:"_setaria_add_loading_count",_SUB_LOADING_COUNT:"_setaria_sub_loading_count",_UPDATE_DIRECTION:"_setaria_update_direction",_UPDATE_ROUTE_HISTORY:"_setaria_update_route_history"},z={SETARIA_STORE_MODULE:"_setaria_common_",GET_IS_LOADING:"_setaria_common_/"+X._GET_IS_LOADING,GET_LOADING_COUNT:"_setaria_common_/"+X._GET_LOADING_COUNT,GET_ROUTE_HISTORY:"_setaria_common_/"+X._GET_ROUTE_HISTORY,GET_ROUTE_CURRENT_INDEX:"_setaria_common_/"+X._GET_ROUTE_CURRENT_INDEX,GET_DIRECTION:"_setaria_common_/"+X._GET_DIRECTION,SET_DIRECTION:"_setaria_common_/"+F._SET_DIRECTION,ADD_LOADING_COUNT:"_setaria_common_/"+F._ADD_LOADING_COUNT,SUB_LOADING_COUNT:"_setaria_common_/"+F._SUB_LOADING_COUNT,UPDATE_DIRECTION:"_setaria_common_/"+F._UPDATE_DIRECTION,UPDATE_ROUTE_HISTORY:"_setaria_common_/"+F._UPDATE_ROUTE_HISTORY},Q={LOCAL:"local",SESSION:"session"},Z={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},ee={NORMAL_ERROR:0,PROMISE_UNREJECT_ERROR:1,VUE_ERROR:2},te={ERROR_TYPES:ee,MESSAGE_TYPE:Z,STORE_KEY:z,STORAGE_TYPE:Q},ne={_setaria_direction:"",_setaria_loading:0,_setaria_routeHistory:{currentIndex:null,history:[]}},re={};re[X._GET_ROUTE_HISTORY]=function(e){return e._setaria_routeHistory},re[X._GET_ROUTE_CURRENT_INDEX]=function(e){return e._setaria_routeHistory.currentIndex},re[X._GET_IS_LOADING]=function(e){return 0!==e._setaria_loading},re[X._GET_LOADING_COUNT]=function(e){return e._setaria_loading},re[X._GET_DIRECTION]=function(e){return e._setaria_direction};var oe={},ie={};ie[F._SET_DIRECTION]=function(e,t){e._setaria_direction=t},ie[F._ADD_LOADING_COUNT]=function(e){e._setaria_loading+=1},ie[F._SUB_LOADING_COUNT]=function(e){var t=e;t._setaria_loading>0&&(t._setaria_loading-=1)},ie[F._UPDATE_DIRECTION]=function(e,t){var n=(t.current,t.next),r=e._setaria_direction,o=e._setaria_routeHistory;if("forward"!==r&&"back"!==r){if(o.history.length>0)if(o.currentIndex===o.history.length-1)r="back";else{0!==o.currentIndex&&o.history[o.currentIndex-1]===n&&(r="back"),""===r&&o.history[o.currentIndex+1]===n&&(r="forward")}else r="forward";"forward"!==r&&"back"!==r&&(r="forward"),e._setaria_direction=r}},ie[F._UPDATE_ROUTE_HISTORY]=function(e,t){var n=t.current,r=t.next,o=e._setaria_direction,i=e._setaria_routeHistory;if("back"===o)0===i.currentIndex?i.currentIndex=null:(i.history[i.currentIndex]=n,i.currentIndex-=1);else if("forward"===o){if(null===i.currentIndex)i.currentIndex=0;else{if(i.currentIndex<i.history.length-1){var a=i.history.splice(0,i.currentIndex+1);i.history=a}i.currentIndex+=1}i.history.push(r)}};var ae,se={},ue={namespaced:!0,state:ne,getters:re,actions:oe,mutations:ie,modules:se},ce={modules:(ae={},ae._setaria_common_=ue,ae),plugins:[]},_e=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=[]),void 0===n&&(n=""),this.id=e,this.type=l(e),this.params=t,this.message=d(this.id,this.params),_(this.message)&&!_(n)&&(this.message=n)};_e.prototype.getMessage=function(){return this.message},_e.prototype.toString=function(){return this.message};var fe="Setaria Error",de=":",le=function(e){function t(t,n,r){void 0===t&&(t=""),void 0===n&&(n=[]),void 0===r&&(r="");var o=r;_(t)&&(t="unknown"),_(r)&&(o=new _e(t,n,r).getMessage());var i=fe+"["+t+"]"+de+o;e.call(this,i),this._name="ApplicationError",this.id=t,this.params=n,this.type=Z.ERROR,this.noIdMessage=o,this.message=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),Ee="__Setaria_Storage_",Se=function(){};Se.setItem=function(e,t,n){R(e,t,n)},Se.getItem=function(e,t){return T(e,t)},Se.setLocalItem=function(e,t){R(Q.LOCAL,e,t)},Se.getLocalItem=function(e){return T(Q.LOCAL,e)},Se.removeLocalItem=function(e){v(Q.LOCAL,e)},Se.clearLocal=function(){I(Q.LOCAL)},Se.setSessionItem=function(e,t){R(Q.SESSION,e,t)},Se.getSessionItem=function(e){return T(Q.SESSION,e)},Se.removeSessionItem=function(e){v(Q.SESSION,e)},Se.clearSession=function(){I(Q.SESSION)};var Oe,pe,Re,Te,ve=function(e,t){Object.keys(t).forEach(function(n){var r=t[n],o=null;o=n===ye?e:N(e,n),o.state=Ie(o.state,n,r)})},Ie=function(e,t,n){var r={},o=me(n,t);return _(o)?e:(Object.keys(e).forEach(function(t){r[t]=u(e[t],t,o)}),r)},he=function(e){var t=Se.getItem(e,"__setaria_store_sync");return void 0!==t&&null!==t||(t={},Se.setItem(e,"__setaria_store_sync",t)),t},ge=function(e,t,n){var r=he(e);r[t]=n,Se.setItem(e,"__setaria_store_sync",r)},me=function(e,t){return he(e)[t]},Ne="/",ye="_root",Ue="undefined"!=typeof window,we=function(){var e=window.navigator.userAgent.toLowerCase();return"undefined"!=typeof window&&e&&/firefox\/\d+/.test(e)},Ae=function(e){function t(t,n,r,o){void 0===t&&(t=""),void 0===n&&(n={}),void 0===r&&(r=[]),void 0===o&&(o=""),e.call(this,t,r,o),this._name="ApplicationError",this.type="ServiceError",this.detail=n,we()&&!1!==s(!0,["config","isShowError"],n)&&x(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(le),Ge="defaults",Ce=function(){};Ce.init=function(){i.config.errorHandler=function(e,t,n){console.debug("The Exception from Vue"),Ce.handleError(ee.VUE_ERROR,e,{vm:t,info:n})},window.onerror=function(e){console.debug("The Exception from window.onerror"),Ce.handleError(ee.NORMAL_ERROR,e,{})};var e=function(e){console.debug("The Exception from promise"),Ce.handleError(ee.PROMISE_UNREJECT_ERROR,e,{})};void 0!==window.unhandledrejectionHandler&&null!==window.unhandledrejectionHandler||(window.onunhandledrejection=e),window.addEventListener("unhandledrejection",e)},Ce.handleError=function(e,t,n){var r=this.parseError(e,t,n);"function"==typeof B.errorHanlder&&B.errorHanlder(r,e,t,n)},Ce.parseError=function(e,t,n){var r=null;return e===ee.VUE_ERROR?r=W(t):e===ee.NORMAL_ERROR?("string"==typeof t&&(t={message:t}),r=W(t)):r=e===ee.PROMISE_UNREJECT_ERROR?W(t.reason):new le("MAM004E"),e===ee.VUE_ERROR&&console.error(t),r};var De={"SYSMSG-SERVICE-UNKNOWN-ERROR":"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002","SYSMSG-TIMEOUT":"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002","SYSMSG-CLIENT-UNKNOWN-ERROR":"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002","SYSMSG-SERVICE-NETWORK-ERROR":"\u8fdc\u7a0b\u670d\u52a1\u5668\u65e0\u6cd5\u8fde\u63a5\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002","SYSMSG-NOT-SUPPORT-STORAGE":"\u5f53\u524d\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7a7a\u95f4\u3002","SYSMSG-SERVICE-STATUS-400":"\u65e0\u6548\u7684\u8bf7\u6c42\u3002","SYSMSG-SERVICE-STATUS-401":"\u5f53\u524d\u8bf7\u6c42\u9700\u8981\u7528\u6237\u9a8c\u8bc1\u3002","SYSMSG-SERVICE-STATUS-403":"\u8fdc\u7a0b\u670d\u52a1\u62d2\u7edd\u6267\u884c\u3002","SYSMSG-SERVICE-STATUS-404":"\u8bf7\u6c42\u6240\u5e0c\u671b\u5f97\u5230\u7684\u8d44\u6e90\u672a\u88ab\u5728\u670d\u52a1\u5668\u4e0a\u53d1\u73b0\u3002"},be=function e(t){void 0===t&&(t={});var n=this;this.initConfig(t),J(e,n),Ce.init()};be.prototype.initConfig=function(e){var t=e.message;void 0===t&&(t={});var n=e.http;void 0===n&&(n={});var r=e.routes;void 0===r&&(r={});var o=e.store;void 0===o&&(o={});var i=e.storeScopeKey;B.message=a(De,t),B.http=n||{},B.routes=r||{},B.store=o||{},c(i)&&(B.storeScopeKey=i)},be.install=q(be),be.version="0.3.2",Ue&&window.Vue&&window.Vue.use(be),e.default=be,e.ApplicationError=le,e.constants=te,e.Message=_e,e.ServiceError=Ae,Object.defineProperty(e,"__esModule",{value:!0})});