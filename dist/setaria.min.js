/**
 * Setaria v0.0.1
 * (c) 2017 Ray Han
 * @license MIT
 */
!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vuex"],n):r.Setaria=n(r.Vue$1,r._,r.moment,null,r.axios,r.Vuex)}(this,function(r,n,e,t,i,o){"use strict";function u(r){Vue||(Vue=r,h(Vue))}function s(){var r={},n=m.message;return g.isEmpty(n)||g.isString(n)||g.isObject(n)&&(r=n),r}function c(){return Object.assign({},y,s())}function a(r){return c()[r]}function f(r,n){void 0===r&&(r="");var e=g.isEmpty(a(r))?"":a(r);return g.isEmpty(e)||g.isEmpty(n)||n.forEach(function(r,t){e=e.split("{"+t+"}").join(n[t])}),e}function d(r){void 0===r&&(r=null);var n="";switch(null!==r?r.charAt(r.length-1):""){case"E":n="error";break;case"W":n="warning";break;case"I":n="info";break;default:n="error"}return n}function l(r){var n=!1;return g.isObject(r)&&!g.isEmpty(r.id)?n=!0:g.isString(r)&&(n=-1!==r.indexOf(M)),n}function p(r){var n=r;g.isObject(r)&&(n=r.message),n=n.replace("Uncaught Error: ","");var e=n.split(x),t=e[0].replace(M,"").replace("[","").replace("]",""),i=e[1];return new b(t,null,i)}function E(r,n,e,t){void 0===t&&(t={});var o=null,u=t;return r===A.GET?(u.params=e,o=i[A.GET](n,u)):o=i[r](n,e,u),new Promise(function(r,n){o.then(function(n){r(n)}).catch(function(r){var e=r;if(0===r.message.indexOf("timeout of")){e=new b("MAM003E",[1e3])}else r.response&&r.response.status>=500&&(e=new b("MAM001E"));n(e)})})}r="default"in r?r.default:r,n="default"in n?n.default:n,e="default"in e?e.default:e,i="default"in i?i.default:i,o="default"in o?o.default:o;var m={message:"",errorHanlder:null,router:{}},h=function(){};"undefined"!=typeof window&&window.Vue&&u(window.Vue);var g=function(){};g.isProdunctionEnv=function(){return!0},g.getNow=function(r){return void 0===r&&(r="LL"),e().format(r)},g.formatDate=function(r,n){void 0===n&&(n="YYYY-MM-DD");var t="";return e(r).isValid()&&void 0!==r&&(t=e(r).format(n)),t},g.toDate=function(r){var n=r;return g.isEmpty(r)||(n=e(r).toDate()),n},g.addDateTime=function(r,n,t){return e(r).add(n,t)},g.subtractDateTime=function(r,n,t){return e(r).subtract(n,t)},g.isEmpty=function(r){return n.isEmpty(r)},g.isEqual=function(r,e){return n.isEqual(r,e)},g.isNumber=function(r){return n.isNumber(r)},g.isString=function(r){return n.isString(r)},g.isDate=function(r){return n.isDate(r)},g.isArray=function(r){return n.isArray(r)},g.isObject=function(r){return n.isObject(r)},g.isFunction=function(r){return n.isFunction(r)},g.get=function(r,e,t){return void 0===t&&(t=null),n.get(r,e,t)},g.cloneDeep=function(r){return n.cloneDeep(r)},g.getUrlParameter=function(r){var n=window.location.search.substring(1),e=n.split("&"),t=e.find(function(n){return n.split("=")[0]===r});return t&&(t=t.split("=")[1]),t};var y={MAM001E:"\u670d\u52a1\u8c03\u7528\u51fa\u73b0\u7f51\u7edc\u9519\u8bef\uff0c\u65e0\u6cd5\u8c03\u7528\u6307\u5b9a\u670d\u52a1\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u670d\u52a1\u8c03\u7528\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002"},v={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},w=function(r,n,e){this.id=r,this.type=d(r),this.params=n,this.message=f(this.id,this.params),g.isEmpty(this.message)&&!g.isEmpty(e)&&(this.message=e)};w.prototype.getMessage=function(){return this.message},w.prototype.toString=function(){return this.message};var M="Setaria Error",x=":",b=function(r){function n(n,e,t){var i=t;g.isEmpty(t)&&(i=new w(n,e,t).getMessage(),i=M+"["+n+"]"+x+i),r.call(this,i),this.id=n,this.params=e,this.type=v.ERROR,this.message=i}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(Error),I=function(){};I.catchError=function(){r.config.errorHandler=function(r,n){I.handleError(r,n)},window.onerror=function(r){I.handleError(r)},window.onunhandledrejection=function(r){I.handleError(r)}},I.handleError=function(r,n){var e=I.parseError(r,n);g.isFunction(m.errorHanlder)&&m.errorHanlder(e,r)},I.parseError=function(r,n){var e=null,t=n instanceof Object;return l(r)?e=p(r):g.isEmpty(r.reason)?r instanceof Error?e=g.isProdunctionEnv()?new b("MAM004E"):r:t?e=g.isProdunctionEnv()?new b("MAM004E"):r:g.isString(r)&&(0===r.indexOf("Uncaught Error: ")&&(e=r.replace("Uncaught Error: ","")),e=new b(null,null,e)):e=r.reason,(null===e||void 0===e||!g.isEmpty(e)&&g.isEmpty(e.message))&&(e=new b("MAM004E")),t&&console.error(r),e};var A={GET:"get",POST:"post",PUT:"put",DELETE:"delete"},O=function(){};O.get=function(r,n,e){return E(A.GET,r,n,e)},O.post=function(r,n,e){return E(A.POST,r,n,e)},O.put=function(r,n,e){return E(A.PUT,r,n,e)},O.delete=function(r,n,e){return E(A.DELETE,r,n,e)};var D,S={direction:"",loading:!1,routeHistory:{currentIndex:null,history:[]}},T={routeHistory:function(r){return r.routeHistory},routeCurrentIndex:function(r){return r.routeHistory.currentIndex}},H={},j={direction:function(r,n){r.direction=n},loading:function(r,n){r.loading=n},updateDirection:function(r,n){var e=(n.current,n.next),t=r.direction;console.log("updateDirection",t);var i=r.routeHistory;if("forward"!==t&&"back"!==t){if(i.history.length>0)if(i.currentIndex===i.history.length-1)t="back";else{0!==i.currentIndex&&i.history[i.currentIndex]===e&&(t="back"),""===t&&i.history[i.currentIndex+1]===e&&(t="forward")}else t="forward";"forward"!==t&&"back"!==t&&(t="forward"),r.direction=t}console.log(r.direction)},updateHistory:function(r,n){var e=n.current,t=n.next,i=r.direction,o=r.routeHistory;if("back"===i)0===o.currentIndex?o.currentIndex=null:(o.history[o.currentIndex]=e,o.currentIndex-=1);else if("forward"===i){if(null===o.currentIndex)o.currentIndex=0;else{if(o.currentIndex<o.history.length-1){var u=o.history.splice(0,o.currentIndex+1);o.history=u}o.currentIndex+=1}o.history.push(t)}}},P={namespaced:!0,state:S,getters:T,actions:H,mutations:j},k={modules:{common:P},strict:!1};r.use(o);var q=function(r){return D=new r(k)}(o.Store);return g.isProdunctionEnv()&&(r.config.silent=!0,r.config.productionTip=!1),I.catchError(),{install:u,config:m,store:q,version:"0.0.1",ApplicationError:b,Http:O,Message:w,util:g}});