/**
 * Setaria v0.0.11
 * (c) 2017 Ray Han
 * @license MIT
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],n):t.Setaria=n(t.Vue,t._,t.moment,null,t.axios,t.VueRouter,t.Vuex)}(this,function(t,n,e,r,o,i,u){"use strict";function c(t){}function a(){return b.message?b.message:{}}function s(){return Object.assign({},L,a())}function f(t){return s()[t]}function d(t,n){void 0===t&&(t=""),void 0===n&&(n=[]);var e=f(t),r=null===e||void 0===e?"":e;return A.isEmpty(r)||A.isEmpty(n)||n.forEach(function(t,n){var e="{"+n+"}";if(-1!==r.indexOf(e)){var o="number"==typeof t?t.toString():t;r=r.split(e).join(o)}}),r}function l(t){var n="";switch(t.charAt(t.length-1)){case"E":n="error";break;case"W":n="warning";break;case"I":default:n="info"}return n}function p(t){var n=!1;return t instanceof Object&&null!==t&&void 0!==t&&null!==t.id&&void 0!==t.id?n=!0:"string"==typeof t&&(n=-1!==t.indexOf(N)),n}function m(t){var n="",e="";if("string"==typeof t){0===t.indexOf("Error: ")?t=t.replace("Error: ",""):0===t.indexOf("Uncaught Error: ")&&(t=t.replace("Uncaught Error: ",""));var r=t.split(k);return n=r[0].replace(N,"").replace("[","").replace("]",""),e=r[1],new _(n,[],e)}return new _(t.id,[],t.noIdMessage)}function v(t){var n=document.createEvent("Event");n.initEvent("unhandledrejection",!1,!0);var e={reason:{value:t,writable:!1}};Object.defineProperties(n,e),window.dispatchEvent(n)}function E(t,n){var e=new j("MAM001E",n);if(null!==t&&void 0!==t){var r=null;switch(t){case 404:r="404";break;default:r="001"}e=new j("MAM"+r+"E",n)}return e}function h(t,n,e,r){return void 0===r&&(r={}),new Promise(function(i,u){var c=null,a=r;t===H.GET||t===H.DELETE||t===H.OPTIONS?(a.params=e,c=o[t](n,a)):c=o[t](n,e,a),c.then(function(t){i(t)}).catch(function(t){var n=new j("MAM001E",t);if(null!==t.response&&void 0!==t.response&&"number"==typeof t.response.status&&(n=E(t.response.status,t)),0===t.message.indexOf("timeout of")){var e=t.config.timeout;n=void 0===e||null===e?new j("MAM007E",t):new j("MAM003E",t,[e])}u(n)})})}function g(t){return t===R.LOCAL?window.localStorage:window.sessionStorage}function y(t,n){g(t).setItem(q,JSON.stringify(n))}function w(t){var n=g(t);return null===n.getItem(q)&&n.setItem(q,JSON.stringify({})),JSON.parse(n.getItem(q))}function S(t,n,e){var r=w(t);r[n]=e,y(t,r)}function M(t,n){return w(t)[n]}function I(t,n){var e=w(t);delete e[n],y(t,e)}function O(t){y(t,{})}function x(t){x.installed||(x.installed=!0,i.install(t),t.mixin({mounted:function(){this.$store&&this.$store.commit("common/direction","")}}))}t="default"in t?t.default:t,n="default"in n?n.default:n,e="default"in e?e.default:e,o="default"in o?o.default:o,i="default"in i?i.default:i,u="default"in u?u.default:u;var b={message:null,errorHanlder:null},A=function(){};A.isProdunctionEnv=function(){return!0},A.getNow=function(t){return void 0===t&&(t="LL"),e().format(t)},A.formatDate=function(t,n){void 0===n&&(n="YYYY-MM-DD");var r="";return e(t).isValid()&&void 0!==t&&(r=e(t).format(n)),r},A.toDate=function(t){var n=t;return A.isEmpty(t)||(n=e(t).toDate()),n},A.addDateTime=function(t,n,r){return e(t).add(n,r)},A.subtractDateTime=function(t,n,r){return e(t).subtract(n,r)},A.isEmpty=function(t){return n.isEmpty(t)},A.isEqual=function(t,e){return n.isEqual(t,e)},A.isNumber=function(t){return n.isNumber(t)},A.isString=function(t){return n.isString(t)},A.isDate=function(t){return n.isDate(t)},A.isArray=function(t){return n.isArray(t)},A.isObject=function(t){return n.isObject(t)},A.isFunction=function(t){return n.isFunction(t)},A.get=function(t,e,r){return void 0===r&&(r=null),n.get(t,e,r)},A.cloneDeep=function(t){return n.cloneDeep(t)},A.getUrlParameter=function(t){var n=window.location.search.substring(1),e=n.split("&"),r=e.find(function(n){return n.split("=")[0]===t});return r=null===r||void 0===r?"":r.split("=")[1]};var L={MAM001E:"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u8bf7\u6c42\u7684\u670d\u52a1\u8bbf\u95ee\u8d85\u65f6\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002",MAM404E:"\u8bf7\u6c42\u7684\u670d\u52a1\u4e0d\u5b58\u5728\u3002"},T={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},P=function(t,n,e){void 0===t&&(t=""),void 0===n&&(n=[]),void 0===e&&(e=""),this.id=t,this.type=l(t),this.params=n,this.message=d(this.id,this.params),A.isEmpty(this.message)&&!A.isEmpty(e)&&(this.message=e)};P.prototype.getMessage=function(){return this.message},P.prototype.toString=function(){return this.message};var N="Setaria Error",k=":",_=function(t){function n(n,e,r){void 0===n&&(n=""),void 0===e&&(e=[]),void 0===r&&(r="");var o=r;A.isEmpty(n)&&(n="unknown"),A.isEmpty(r)&&(o=new P(n,e,r).getMessage());var i=N+"["+n+"]"+k+o;t.call(this,i),this.id=n,this.params=e,this.type=T.ERROR,this.noIdMessage=o,this.message=i}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n}(Error),D=function(){};D.catchError=function(){t.config.errorHandler=function(t,n){D.handleError(t,n)},window.onerror=function(t){D.handleError(t)},window.addEventListener("unhandledrejection",function(t){D.handleError(t)})},D.handleError=function(t,n){var e=this.parseError(t,n);"function"==typeof b.errorHanlder&&b.errorHanlder(e,t)},D.parseError=function(t,n){var e=null,r=n instanceof Object;if(p(t))e=m(t);else if("unhandledrejection"===t.type&&"object"==typeof t){var o=t.reason,i=o.id,u=o.message,c=o.noIdMessage;e=null!==c&&void 0!==c?new _(i,[],c):null!==u&&void 0!==u?new _("",[],u):new _("MAM004E")}else if(r&&t instanceof Error)if(A.isProdunctionEnv())e=new _("MAM004E");else{var a=t.message;e=new _("",[],a)}else e="string"==typeof t?0===t.indexOf("Uncaught Error: ")?new _("",[],t.replace("Uncaught Error: ","")):new _("",[],t):new _("MAM004E");return r&&console.error(t),e};var j=function(t){function n(n,e,r,o){void 0===n&&(n=""),void 0===r&&(r=[]),void 0===o&&(o=""),t.call(this,n,r,o),v(this)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n}(_),H={GET:"get",POST:"post",PUT:"put",DELETE:"delete",OPTIONS:"options",PATCH:"patch"},C=function(){};C.get=function(t,n,e){return h(H.GET,t,n,e)},C.post=function(t,n,e){return h(H.POST,t,n,e)},C.put=function(t,n,e){return h(H.PUT,t,n,e)},C.delete=function(t,n,e){return h(H.DELETE,t,n,e)},C.options=function(t,n,e){return h(H.OPTIONS,t,n,e)},C.patch=function(t,n,e){return h(H.PATCH,t,n,e)};var q="__Setaria_Storage_",R={LOCAL:"local",SESSION:"session"},U=function(){};U.setLocalItem=function(t,n){S(R.LOCAL,t,n)},U.getLocalItem=function(t){return M(R.LOCAL,t)},U.removeLocalItem=function(t){I(R.LOCAL,t)},U.clearLocal=function(){O(R.LOCAL)},U.setSessionItem=function(t,n){S(R.SESSION,t,n)},U.getSessionItem=function(t){return M(R.SESSION,t)},U.removeSessionItem=function(t){I(R.SESSION,t)},U.clearSession=function(){O(R.SESSION)};var V,G={direction:"",loading:!1,routeHistory:{currentIndex:null,history:[]},token:"",user:null},Y={routeHistory:function(t){return t.routeHistory},routeCurrentIndex:function(t){return t.routeHistory.currentIndex}},$={},F={direction:function(t,n){t.direction=n},loading:function(t,n){t.loading=n},token:function(t,n){t.token=n},user:function(t,n){t.user=n},updateDirection:function(t,n){var e=(n.current,n.next),r=t.direction,o=t.routeHistory;if("forward"!==r&&"back"!==r){if(o.history.length>0)if(o.currentIndex===o.history.length-1)r="back";else{0!==o.currentIndex&&o.history[o.currentIndex-1]===e&&(r="back"),""===r&&o.history[o.currentIndex+1]===e&&(r="forward")}else r="forward";"forward"!==r&&"back"!==r&&(r="forward"),t.direction=r}},updateHistory:function(t,n){var e=n.current,r=n.next,o=t.direction,i=t.routeHistory;if("back"===o)0===i.currentIndex?i.currentIndex=null:(i.history[i.currentIndex]=e,i.currentIndex-=1);else if("forward"===o){if(null===i.currentIndex)i.currentIndex=0;else{if(i.currentIndex<i.history.length-1){var u=i.history.splice(0,i.currentIndex+1);i.history=u}i.currentIndex+=1}i.history.push(r)}}},J={namespaced:!0,state:G,getters:Y,actions:$,mutations:F},z={modules:{common:J},strict:!1};t.use(u);var W=function(t){return V=new t(z)}(u.Store),B=function(t,n,e){var r=t.params,o=n.fullPath,i=W.state.common.direction,u=t.fullPath;r&&"forward"===r.$$direction&&(i="forward",W.commit("common/direction",i)),W.commit("common/updateDirection",{current:o,next:u}),e()},K=function(t,n,e){var r=n.fullPath,o=t.fullPath;W.commit("common/updateHistory",{current:r,next:o}),e()},Q=function(t){function n(n){void 0===n&&(n={}),t.call(this,n),this.beforeEach(B),this.beforeEach(K)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.forwardTo=function(t,n,e){void 0===n&&(n={}),void 0===e&&(e={}),W.commit("common/direction","forward"),this.push({name:t,params:n,query:e})},n.prototype.backTo=function(){t.prototype.back.call(this)},n.prototype.back=function(){W.commit("common/direction","back"),t.prototype.back.call(this)},n.prototype.forward=function(){W.commit("common/direction","forward"),t.prototype.forward.call(this)},n}(i);return Q.install=x,"undefined"!=typeof window&&window.Vue&&window.Vue.use(Q),A.isProdunctionEnv()&&(t.config.silent=!0,t.config.productionTip=!1),D.catchError(),{install:c,config:b,plugin:{Navigate:Q,store:W},version:"0.0.11",ApplicationError:_,ServiceError:j,Http:C,Message:P,Storage:U,util:A}});