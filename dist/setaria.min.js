/**
 * Setaria v0.2.11
 * (c) 2018 Ray Han
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],t):e.Setaria=t(e.Vue,e._,e.moment,null,e.axios,e.VueRouter,e.Vuex)}(this,function(e,t,r,n,o,i,a){"use strict";function s(e){}function u(){return L.message?L.message:{}}function c(){return C.assign({},x,u())}function _(e){return c()[e]}function f(e,t){void 0===e&&(e=""),void 0===t&&(t=[]);var r=_(e),n=null===r||void 0===r?"":r;return C.isEmpty(n)||C.isEmpty(t)||t.forEach(function(e,t){var r="{"+t+"}";if(-1!==n.indexOf(r)){var o="number"==typeof e?e.toString():e;n=n.split(r).join(o)}}),n}function d(e){var t="";switch(e.charAt(e.length-1)){case"E":t="error";break;case"W":t="warning";break;case"I":default:t="info"}return t}function l(e){return"object"==typeof e&&e._name&&"ApplicationError"===e._name}function E(e){var t=null,r="",n="";if(l(e))t=new q(e.id,[],e.noIdMessage);else if(e.message){n=e.message,0===n.indexOf("Error: ")?n=n.replace("Error: ",""):0===n.indexOf("Uncaught Error: ")&&(n=n.replace("Uncaught Error: ",""));var o=n.split(V);r=o[0].replace(Y,"").replace("[","").replace("]",""),n=o[1],t=new q(r,[],n)}else t="function"==typeof e.toString?new q(null,null,e.toString()):new q("MAM004E");return t}function m(e){var t=document.createEvent("Event");t.initEvent("unhandledrejection",!1,!0);var r={reason:{value:e,writable:!1}};Object.defineProperties(t,r),window.dispatchEvent(t)}function p(e){var t=null;try{t=e===B.LOCAL?window.localStorage:window.sessionStorage}catch(e){throw new q("SYSMSG-NOT-SUPPORT-STORAGE")}if(void 0===t)throw new q("SYSMSG-NOT-SUPPORT-STORAGE");return t}function S(e,t){p(e).setItem(z,JSON.stringify(t))}function g(e){var t=p(e);return null===t.getItem(z)&&t.setItem(z,JSON.stringify({})),JSON.parse(t.getItem(z))}function v(e){return Object.keys(B).some(function(t){return B[t]===e})}function h(e,t,r){if(v(e)){var n=g(e);n[t]=r,S(e,n)}}function O(e,t){if(v(e))return g(e)[t]}function R(e,t){if(v(e)){var r=g(e);delete r[t],S(e,r)}}function y(e){S(e,{})}function T(e){return Array.isArray(e)?e.map(function(e){return{key:e,val:e}}):Object.keys(e).map(function(t){return{key:t,val:e[t]}})}function I(){return me}function w(e,t,r){var n=t;r&&(n.state=Z(n.state,e,r),F.sync[e]=r),me.registerModule(e,t)}function N(e){var t=I();return t&&!1!==e.showLoading&&t.commit($.ADD_LOADING_COUNT),e}function b(e){var t=I();return t&&!1!==e.config.showLoading&&t.commit($.SUB_LOADING_COUNT),e}function A(e){if(b({config:e.config}),e.response){console.debug("server have response",e);var t="";switch(e.response.status){case 400:t="400";break;case 401:t="401";break;case 403:t="403";break;case 404:t="404";break;default:t=""}var r="SYSMSG-SERVICE-UNKNOWN-ERROR";throw""!==t&&(r="SYSMSG-SERVICE-STATUS-"+t),new W(r,e)}if(!e.request)throw console.debug("Something happened in setting up the request that triggered an Error",e),0===e.message.indexOf("timeout of ")?new W("SYSMSG-TIMEOUT",e,[e.config.timeout/1e3]):0===e.message.indexOf("Network Error")?new W("SYSMSG-SERVICE-NETWORK-ERROR",e):new W("SYSMSG-SERVICE-UNKNOWN-ERROR",e);return console.debug("The request was made but no response was received",e),Promise.reject(e)}function U(e){U.installed||(U.installed=!0,i.install(e),e.mixin({mounted:function(){this.$store&&this.$store.commit($.SET_DIRECTION,"")}}))}e="default"in e?e.default:e,t="default"in t?t.default:t,r="default"in r?r.default:r,o="default"in o?o.default:o,i="default"in i?i.default:i,a="default"in a?a.default:a;var x={"SYSMSG-SERVICE-UNKNOWN-ERROR":"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002","SYSMSG-TIMEOUT":"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002","SYSMSG-CLIENT-UNKNOWN-ERROR":"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002","SYSMSG-SERVICE-NETWORK-ERROR":"\u8fdc\u7a0b\u670d\u52a1\u5668\u65e0\u6cd5\u8fde\u63a5\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002","SYSMSG-NOT-SUPPORT-STORAGE":"\u5f53\u524d\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7a7a\u95f4\u3002","SYSMSG-SERVICE-STATUS-400":"\u65e0\u6548\u7684\u8bf7\u6c42\u3002","SYSMSG-SERVICE-STATUS-401":"\u5f53\u524d\u8bf7\u6c42\u9700\u8981\u7528\u6237\u9a8c\u8bc1\u3002","SYSMSG-SERVICE-STATUS-403":"\u8fdc\u7a0b\u670d\u52a1\u62d2\u7edd\u6267\u884c\u3002","SYSMSG-SERVICE-STATUS-404":"\u8bf7\u6c42\u6240\u5e0c\u671b\u5f97\u5230\u7684\u8d44\u6e90\u672a\u88ab\u5728\u670d\u52a1\u5668\u4e0a\u53d1\u73b0\u3002"},C=function(){};C.isProdunctionEnv=function(){return!0},C.isFirefox=function(){var e=window.navigator.userAgent.toLowerCase();return"undefined"!=typeof window&&e&&/firefox\/\d+/.test(e)},C.getNow=function(e){return void 0===e&&(e="LL"),r().format(e)},C.formatDate=function(e,t){void 0===t&&(t="YYYY-MM-DD");var n="";return r(e).isValid()&&void 0!==e&&(n=r(e).format(t)),n},C.toDate=function(e){var t=e;return C.isEmpty(e)||(t=r(e).toDate()),t},C.addDateTime=function(e,t,n){return r(e).add(t,n)},C.subtractDateTime=function(e,t,n){return r(e).subtract(t,n)},C.isEmpty=function(e){return t.isEmpty(e)},C.isEqual=function(e,r){return t.isEqual(e,r)},C.isNumber=function(e){return t.isNumber(e)},C.isString=function(e){return t.isString(e)},C.isDate=function(e){return t.isDate(e)},C.isArray=function(e){return t.isArray(e)},C.isObject=function(e){return t.isObject(e)},C.isFunction=function(e){return t.isFunction(e)},C.get=function(e,r,n){return void 0===n&&(n=null),t.get(e,r,n)},C.cloneDeep=function(e){return t.cloneDeep(e)},C.getUrlParameter=function(e){var t=window.location.search.substring(1),r=t.split("&"),n=r.find(function(t){return t.split("=")[0]===e});return n=null===n||void 0===n?"":n.split("=")[1]},C.assign=function(e){return t.assign.apply(null,arguments)};var M={$env:{},env:{dev:{},prod:{}},errorHanlder:null,message:{},router:{routes:[]},auth:{storageMode:"none"},storeSync:{}};try{var D=require((process.env.SETARIA_CONFIG_CONTEXT||process.cwd())+"/setaria.config.js");void 0!==D&&null!==D&&(M=C.assign({},M,D.default)),M.message=C.assign({},x,M.message)}catch(e){}var k=C.get(M,"env.dev",{}),G=C.get(M,"env.prod",{});C.isEmpty(k)&&C.isEmpty(G)&&!C.isEmpty(M.env)&&(G=M.env),M.$env=M.env,C.isProdunctionEnv()?M.env=C.assign({},G):M.env=C.assign({},G,k);var L=M,j={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},P=function(e,t,r){void 0===e&&(e=""),void 0===t&&(t=[]),void 0===r&&(r=""),this.id=e,this.type=d(e),this.params=t,this.message=f(this.id,this.params),C.isEmpty(this.message)&&!C.isEmpty(r)&&(this.message=r)};P.prototype.getMessage=function(){return this.message},P.prototype.toString=function(){return this.message};var Y="Setaria Error",V=":",q=function(e){function t(t,r,n){void 0===t&&(t=""),void 0===r&&(r=[]),void 0===n&&(n="");var o=n;C.isEmpty(t)&&(t="unknown"),C.isEmpty(n)&&(o=new P(t,r,n).getMessage());var i=Y+"["+t+"]"+V+o;e.call(this,i),this._name="ApplicationError",this.id=t,this.params=r,this.type=j.ERROR,this.noIdMessage=o,this.message=i}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),H={NORMAL_ERROR:0,PROMISE_UNREJECT_ERROR:1,VUE_ERROR:2},K=function(){};K.catchError=function(){e.config.errorHandler=function(e,t,r){console.debug("The Exception from Vue"),K.handleError(H.VUE_ERROR,e,{vm:t,info:r})},window.onerror=function(e){console.debug("The Exception from window.onerror"),K.handleError(H.NORMAL_ERROR,e,{})};var t=function(e){console.debug("The Exception from promise"),K.handleError(H.PROMISE_UNREJECT_ERROR,e,{})};void 0!==window.unhandledrejectionHandler&&null!==window.unhandledrejectionHandler||(window.onunhandledrejection=t),window.addEventListener("unhandledrejection",t)},K.handleError=function(e,t,r){var n=this.parseError(e,t,r);"function"==typeof L.errorHanlder&&L.errorHanlder(n,e,t,r)},K.parseError=function(e,t,r){var n=null;return e===H.VUE_ERROR?n=E(t):e===H.NORMAL_ERROR?("string"==typeof t&&(t={message:t}),n=E(t)):n=e===H.PROMISE_UNREJECT_ERROR?E(t.reason):new q("MAM004E"),e===H.VUE_ERROR&&console.error(t),n};var W=function(e){function t(t,r,n,o){void 0===t&&(t=""),void 0===r&&(r={}),void 0===n&&(n=[]),void 0===o&&(o=""),e.call(this,t,n,o),this._name="ApplicationError",this.type="ServiceError",this.detail=r,C.isFirefox()&&!1!==C.get(r,"config.isShowError",!0)&&m(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(q),F={sync:{}},J="_setaria_auth_",$={MODULE_SETARIA_STORE:"_setaria_common_",GET_IS_LOADING:"_setaria_common_/_setaria_get_is_loading",GET_LOADING_COUNT:"_setaria_common_/_setaria_get_loading_count",GET_ROUTE_HISTORY:"_setaria_common_/_setaria_get_route_history",GET_ROUTE_CURRENT_INDEX:"_setaria_common_/_setaria_get_route_current_index",GET_DIRECTION:"_setaria_common_/_setaria_get_direction",SET_DIRECTION:"_setaria_common_/_setaria_set_direction",ADD_LOADING_COUNT:"_setaria_common_/_setaria_add_loading_count",SUB_LOADING_COUNT:"_setaria_common_/_setaria_sub_loading_count",UPDATE_DIRECTION:"_setaria_common_/_setaria_update_direction",UPDATE_ROUTE_HISTORY:"_setaria_common_/_setaria_update_route_history",MODULE_AUTH:J,GET_USER:"_setaria_common_/_setaria_auth_/_setaria_get_user",GET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_get_token",SET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_set_token",SET_USER:"_setaria_common_/_setaria_auth_/_setaria_set_user"},z="__Setaria_Storage_",B={LOCAL:"local",SESSION:"session"},X=function(){};X.setItem=function(e,t,r){h(e,t,r)},X.getItem=function(e,t){return O(e,t)},X.setLocalItem=function(e,t){h(B.LOCAL,e,t)},X.getLocalItem=function(e){return O(B.LOCAL,e)},X.removeLocalItem=function(e){R(B.LOCAL,e)},X.clearLocal=function(){y(B.LOCAL)},X.setSessionItem=function(e,t){h(B.SESSION,e,t)},X.getSessionItem=function(e){return O(B.SESSION,e)},X.removeSessionItem=function(e){R(B.SESSION,e)},X.clearSession=function(){y(B.SESSION)};var Q=function(e,t,r,n){var o=C.get(ne(n,r),e);return void 0===o&&(o=t),o},Z=function(e,t,r){var n={};return T(e).forEach(function(e){var o=e.key,i=e.val,a=i;a=Q(o,i,t,r),n[o]=a}),n},ee=function(e){return e.replace(/\//g,".")},te=function(e){var t=X.getItem(e,"__setaria_store_sync");return void 0!==t&&null!==t||(t={},X.setItem(e,"__setaria_store_sync",t)),t},re=function(e,t,r){var n=te(e),o=C.get(n,t,{});C.assign(o,r),n[t]=o,X.setItem(e,"__setaria_store_sync",n)},ne=function(e,t){return te(e)[t]};L&&(F.sync["_setaria_common_/_setaria_auth_"]=L.auth.storageMode);var oe=Z({_setaria_token:"",_setaria_user:null},"_setaria_common_/_setaria_auth_",L.auth.storageMode),ie={};ie._setaria_get_user=function(e){return e._setaria_user},ie._setaria_get_token=function(e){return e._setaria_token};var ae={},se={};se._setaria_set_token=function(e,t){e._setaria_token=t},se._setaria_set_user=function(e,t){e._setaria_user=t};var ue={namespaced:!0,name:"_setaria_auth_",state:oe,getters:ie,actions:ae,mutations:se},ce={_setaria_direction:"",_setaria_loading:0,_setaria_routeHistory:{currentIndex:null,history:[]}},_e={};_e._setaria_get_route_history=function(e){return e._setaria_routeHistory},_e._setaria_get_route_current_index=function(e){return e._setaria_routeHistory.currentIndex},_e._setaria_get_is_loading=function(e){return 0!==e._setaria_loading},_e._setaria_get_loading_count=function(e){return e._setaria_loading},_e._setaria_get_direction=function(e){return e._setaria_direction};var fe={},de={};de._setaria_set_direction=function(e,t){e._setaria_direction=t},de._setaria_add_loading_count=function(e){e._setaria_loading+=1},de._setaria_sub_loading_count=function(e){var t=e;t._setaria_loading>0&&(t._setaria_loading-=1)},de._setaria_update_direction=function(e,t){var r=(t.current,t.next),n=e._setaria_direction,o=e._setaria_routeHistory;if("forward"!==n&&"back"!==n){if(o.history.length>0)if(o.currentIndex===o.history.length-1)n="back";else{0!==o.currentIndex&&o.history[o.currentIndex-1]===r&&(n="back"),""===n&&o.history[o.currentIndex+1]===r&&(n="forward")}else n="forward";"forward"!==n&&"back"!==n&&(n="forward"),e._setaria_direction=n}},de._setaria_update_route_history=function(e,t){var r=t.current,n=t.next,o=e._setaria_direction,i=e._setaria_routeHistory;if("back"===o)0===i.currentIndex?i.currentIndex=null:(i.history[i.currentIndex]=r,i.currentIndex-=1);else if("forward"===o){if(null===i.currentIndex)i.currentIndex=0;else{if(i.currentIndex<i.history.length-1){var a=i.history.splice(0,i.currentIndex+1);i.history=a}i.currentIndex+=1}i.history.push(n)}};var le={};le[ue.name]=ue;var Ee,me,pe={namespaced:!0,name:"_setaria_common_",state:ce,getters:_e,actions:fe,mutations:de,modules:le},Se=function(e){e.subscribe(function(e,t){var r=e.type;e.payload;Object.keys(F.sync).forEach(function(e){if(0===r.indexOf(e)){var n=F.sync[e];re(n,e,C.get(t,ee(e)))}})})},ge=[Se],ve={modules:(Ee={},Ee[pe.name]=pe,Ee),plugins:ge,strict:!1},he=o,Oe=C.get(L,"http"),Re=C.get(Oe,"defaults");Re&&(console.debug(Re),Object.keys(Re).forEach(function(e){o.defaults[e]=Re[e]}));null!==Oe&&void 0!==Oe&&Object.keys(Oe).some(function(e){return"defaults"!==e})&&(he={},Object.keys(Oe).forEach(function(e){var t=Oe[e];t.showLoading=!0,he[e]=o.create(t),he[e].all=o.all,he[e].spread=o.spread})),"function"==typeof he?(he.interceptors.request.use(N),he.interceptors.response.use(b,A)):Object.keys(he).forEach(function(e){he[e].interceptors.request.use(N),he[e].interceptors.response.use(b,A)});var ye=he;e.use(a);var Te=function(e){return null!==me&&void 0!==me||(me=new e(ve)),me}(a.Store),Ie=function(e,t,r){var n=e.params,o=t.fullPath,i=Te.state[$.GET_DIRECTION],a=e.fullPath;n&&"forward"===n.$$direction&&(i="forward",Te.commit($.SET_DIRECTION,i)),Te.commit($.UPDATE_DIRECTION,{current:o,next:a}),r()},we=function(e,t,r){var n=t.fullPath,o=e.fullPath;Te.commit($.UPDATE_ROUTE_HISTORY,{current:n,next:o}),r()},Ne=function(e){function t(t){void 0===t&&(t={}),e.call(this,t),this.beforeEach(Ie),this.beforeEach(we),this.afterEach(function(){Te.commit($.SET_DIRECTION,"")})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.forwardTo=function(e,t,r){void 0===t&&(t={}),void 0===r&&(r={}),Te.commit($.SET_DIRECTION,"forward"),C.isObject(e)?this.push(e):this.push({name:e,params:t,query:r})},t.prototype.backTo=function(){e.prototype.back.call(this)},t.prototype.back=function(){Te.commit($.SET_DIRECTION,"back"),e.prototype.back.call(this)},t.prototype.forward=function(){Te.commit($.SET_DIRECTION,"forward"),e.prototype.forward.call(this)},t}(i);Ne.install=U,"undefined"!=typeof window&&e.use(Ne),C.isProdunctionEnv()&&(e.config.silent=!0,e.config.productionTip=!1);var be=new Ne(L.router);return K.catchError(),{ApplicationError:q,Http:ye,Message:P,ServiceError:W,Storage:X,storageTypes:B,config:L,install:s,plugin:{router:be,store:Te},router:be,store:Te,storeRegister:w,storeTypes:$,util:C,version:"0.2.11"}});