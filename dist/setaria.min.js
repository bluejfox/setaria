/**
 * Setaria v0.0.4
 * (c) 2017 Ray Han
 * @license MIT
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],r):t.Setaria=r(t.Vue$1,t._,t.moment,null,t.axios,t.VueRouter,t.Vuex)}(this,function(t,r,n,e,o,i,u){"use strict";function c(t){Vue||(Vue=t,g(Vue))}function a(){var t={},r=y.message;return v.isEmpty(r)||v.isString(r)||v.isObject(r)&&(t=r),t}function s(){return Object.assign({},w,a())}function f(t){return s()[t]}function d(t,r){void 0===t&&(t="");var n=v.isEmpty(f(t))?"":f(t);return v.isEmpty(n)||v.isEmpty(r)||r.forEach(function(t,e){n=n.split("{"+e+"}").join(r[e])}),n}function l(t){void 0===t&&(t=null);var r="";switch(null!==t?t.charAt(t.length-1):""){case"E":r="error";break;case"W":r="warning";break;case"I":r="info";break;default:r="error"}return r}function p(t){var r=!1;return v.isObject(t)&&!v.isEmpty(t.id)?r=!0:v.isString(t)&&(r=-1!==t.indexOf(b)),r}function m(t){var r=t;v.isObject(t)&&(r=t.message),r=r.replace("Uncaught Error: ","");var n=r.split(I),e=n[0].replace(b,"").replace("[","").replace("]",""),o=n[1];return new A(e,null,o)}function h(t,r,n,e){void 0===e&&(e={});var i=null,u=e;return t===D.GET?(u.params=n,i=o[D.GET](r,u)):i=o[t](r,n,u),new Promise(function(t,r){i.then(function(r){t(r)}).catch(function(t){var n=t;if(0===t.message.indexOf("timeout of")){n=new A("MAM003E",[1e3])}else t.response&&t.response.status>=500&&(n=new A("MAM001E"));r(n)})})}function E(t){E.installed||(E.installed=!0,i.install(t),t.mixin({destroyed:function(){this.$store.commit("common/direction","")}}))}t="default"in t?t.default:t,r="default"in r?r.default:r,n="default"in n?n.default:n,o="default"in o?o.default:o,i="default"in i?i.default:i,u="default"in u?u.default:u;var y={message:"",errorHanlder:null,router:{}},g=function(){};"undefined"!=typeof window&&window.Vue&&c(window.Vue);var v=function(){};v.isProdunctionEnv=function(){return!0},v.getNow=function(t){return void 0===t&&(t="LL"),n().format(t)},v.formatDate=function(t,r){void 0===r&&(r="YYYY-MM-DD");var e="";return n(t).isValid()&&void 0!==t&&(e=n(t).format(r)),e},v.toDate=function(t){var r=t;return v.isEmpty(t)||(r=n(t).toDate()),r},v.addDateTime=function(t,r,e){return n(t).add(r,e)},v.subtractDateTime=function(t,r,e){return n(t).subtract(r,e)},v.isEmpty=function(t){return r.isEmpty(t)},v.isEqual=function(t,n){return r.isEqual(t,n)},v.isNumber=function(t){return r.isNumber(t)},v.isString=function(t){return r.isString(t)},v.isDate=function(t){return r.isDate(t)},v.isArray=function(t){return r.isArray(t)},v.isObject=function(t){return r.isObject(t)},v.isFunction=function(t){return r.isFunction(t)},v.get=function(t,n,e){return void 0===e&&(e=null),r.get(t,n,e)},v.cloneDeep=function(t){return r.cloneDeep(t)},v.getUrlParameter=function(t){var r=window.location.search.substring(1),n=r.split("&"),e=n.find(function(r){return r.split("=")[0]===t});return e&&(e=e.split("=")[1]),e};var w={MAM001E:"\u670d\u52a1\u8c03\u7528\u51fa\u73b0\u7f51\u7edc\u9519\u8bef\uff0c\u65e0\u6cd5\u8c03\u7528\u6307\u5b9a\u670d\u52a1\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u670d\u52a1\u8c03\u7528\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002"},x={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},M=function(t,r,n){this.id=t,this.type=l(t),this.params=r,this.message=d(this.id,this.params),v.isEmpty(this.message)&&!v.isEmpty(n)&&(this.message=n)};M.prototype.getMessage=function(){return this.message},M.prototype.toString=function(){return this.message};var b="Setaria Error",I=":",A=function(t){function r(r,n,e){var o=e;v.isEmpty(e)&&(o=new M(r,n,e).getMessage(),o=b+"["+r+"]"+I+o),t.call(this,o),this.id=r,this.params=n,this.type=x.ERROR,this.message=o}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r}(Error),O=function(){};O.catchError=function(){t.config.errorHandler=function(t,r){O.handleError(t,r)},window.onerror=function(t){O.handleError(t)},window.onunhandledrejection=function(t){O.handleError(t)}},O.handleError=function(t,r){var n=O.parseError(t,r);v.isFunction(y.errorHanlder)&&y.errorHanlder(n,t)},O.parseError=function(t,r){var n=null,e=r instanceof Object;return p(t)?n=m(t):v.isEmpty(t.reason)?t instanceof Error?n=v.isProdunctionEnv()?new A("MAM004E"):t:e?n=v.isProdunctionEnv()?new A("MAM004E"):t:v.isString(t)&&(0===t.indexOf("Uncaught Error: ")&&(n=t.replace("Uncaught Error: ","")),n=new A(null,null,n)):n=t.reason,(null===n||void 0===n||!v.isEmpty(n)&&v.isEmpty(n.message))&&(n=new A("MAM004E")),e&&console.error(t),n};var D={GET:"get",POST:"post",PUT:"put",DELETE:"delete"},T=function(){};T.get=function(t,r,n){return h(D.GET,t,r,n)},T.post=function(t,r,n){return h(D.POST,t,r,n)},T.put=function(t,r,n){return h(D.PUT,t,r,n)},T.delete=function(t,r,n){return h(D.DELETE,t,r,n)};var P,S={direction:"",loading:!1,routeHistory:{currentIndex:null,history:[]}},H={routeHistory:function(t){return t.routeHistory},routeCurrentIndex:function(t){return t.routeHistory.currentIndex}},j={},k={direction:function(t,r){t.direction=r},loading:function(t,r){t.loading=r},updateDirection:function(t,r){var n=(r.current,r.next),e=t.direction;console.log("updateDirection",e);var o=t.routeHistory;if("forward"!==e&&"back"!==e){if(o.history.length>0)if(o.currentIndex===o.history.length-1)e="back";else{0!==o.currentIndex&&o.history[o.currentIndex]===n&&(e="back"),""===e&&o.history[o.currentIndex+1]===n&&(e="forward")}else e="forward";"forward"!==e&&"back"!==e&&(e="forward"),t.direction=e}console.log(t.direction)},updateHistory:function(t,r){var n=r.current,e=r.next,o=t.direction,i=t.routeHistory;if("back"===o)0===i.currentIndex?i.currentIndex=null:(i.history[i.currentIndex]=n,i.currentIndex-=1);else if("forward"===o){if(null===i.currentIndex)i.currentIndex=0;else{if(i.currentIndex<i.history.length-1){var u=i.history.splice(0,i.currentIndex+1);i.history=u}i.currentIndex+=1}i.history.push(e)}}},V={namespaced:!0,state:S,getters:H,actions:j,mutations:k},q={modules:{common:V},strict:!1};t.use(u);var _=function(t){return P=new t(q)}(u.Store),R=function(t,r,n){var e=t.params,o=r.fullPath,i=_.state.common.direction,u=t.fullPath;e&&"forward"===e.$$direction&&(i="forward",_.commit("common/direction",i)),_.commit("common/updateDirection",{current:o,next:u}),n()},N=function(t,r,n){var e=r.fullPath,o=t.fullPath;_.commit("common/updateHistory",{current:e,next:o}),n()},U=function(t){function r(r){void 0===r&&(r={}),t.call(this,r),this.beforeEach(R),this.beforeEach(N)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.forwardTo=function(t,r,n){void 0===r&&(r={}),void 0===n&&(n={}),_.commit("common/direction","forward"),this.push({name:t,params:r,query:n})},r.prototype.push=function(r,n,e){_.commit("common/direction","forward"),t.prototype.push.call(this,r,n,e)},r.prototype.forward=function(){_.commit("common/direction","forward"),t.prototype.forward.call(this)},r.prototype.backTo=function(){_.commit("common/direction","back"),t.prototype.back.call(this)},r}(i);return U.install=E,"undefined"!=typeof window&&window.Vue&&window.Vue.use(U),v.isProdunctionEnv()&&(t.config.silent=!0,t.config.productionTip=!1),O.catchError(),{install:c,config:y,plugin:{Navigate:U,store:_},version:"0.0.4",ApplicationError:A,Http:T,Message:M,util:v}});