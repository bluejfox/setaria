/**
 * Setaria v0.2.8
 * (c) 2018 Ray Han
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],e):t.Setaria=e(t.Vue,t._,t.moment,null,t.axios,t.VueRouter,t.Vuex)}(this,function(t,e,n,r,i,o,a){"use strict";function s(t){}function u(){return H.message?H.message:{}}function c(){return Object.assign({},L,u())}function _(t){return c()[t]}function f(t,e){void 0===t&&(t=""),void 0===e&&(e=[]);var n=_(t),r=null===n||void 0===n?"":n;return C.isEmpty(r)||C.isEmpty(e)||e.forEach(function(t,e){var n="{"+e+"}";if(-1!==r.indexOf(n)){var i="number"==typeof t?t.toString():t;r=r.split(n).join(i)}}),r}function d(t){var e="";switch(t.charAt(t.length-1)){case"E":e="error";break;case"W":e="warning";break;case"I":default:e="info"}return e}function l(t){return"object"==typeof t&&t._name&&"ApplicationError"===t._name}function m(t){var e=null,n="",r="";if(l(t))e=new J(t.id,[],t.noIdMessage);else if(t.message){r=t.message,0===r.indexOf("Error: ")?r=r.replace("Error: ",""):0===r.indexOf("Uncaught Error: ")&&(r=r.replace("Uncaught Error: ",""));var i=r.split(Y);n=i[0].replace(F,"").replace("[","").replace("]",""),r=i[1],e=new J(n,[],r)}else e="function"==typeof t.toString?new J(null,null,t.toString()):new J("MAM004E");return e}function E(t){var e=document.createEvent("Event");e.initEvent("unhandledrejection",!1,!0);var n={reason:{value:t,writable:!1}};Object.defineProperties(e,n),window.dispatchEvent(e)}function p(t){var e=null;try{e=t===Q.LOCAL?window.localStorage:window.sessionStorage}catch(t){throw new J("MAM009E")}if(void 0===e)throw new J("MAM009E");return e}function h(t,e){p(t).setItem(X,JSON.stringify(e))}function v(t){var e=p(t);return null===e.getItem(X)&&e.setItem(X,JSON.stringify({})),JSON.parse(e.getItem(X))}function g(t){return Object.keys(Q).some(function(e){return Q[e]===t})}function y(t,e,n){if(g(t)){var r=v(t);r[e]=n,h(t,r)}}function O(t,e){if(g(t))return v(t)[e]}function I(t,e){if(g(t)){var n=v(t);delete n[e],h(t,n)}}function T(t){h(t,{})}function w(t){return Array.isArray(t)?t.map(function(t){return{key:t,val:t}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}})}function S(){return pt}function R(t,e){var n=new z("MAM001E",e);if(null!==t&&void 0!==t){var r=null;switch(t){case 404:r="404";break;default:r="001"}n=new z("MAM"+r+"E",e)}return n}function A(t,e,n,r){return void 0===r&&(r={}),new Promise(function(o,a){var s=null,u=r;t===Ot.GET||t===Ot.DELETE||t===Ot.OPTIONS?(u.params=n,s=i[t](e,u)):s=i[t](e,n,u);var c=S();!1!==r.loading&&null!==c&&void 0!==c&&c.commit(W.ADD_LOADING_COUNT),s.then(function(t){!1!==r.loading&&null!==c&&void 0!==c&&c.commit(W.SUB_LOADING_COUNT),o(t)}).catch(function(t){!1!==r.loading&&null!==c&&void 0!==c&&c.commit(W.SUB_LOADING_COUNT);var e=new z("MAM001E",t);if(null!==t.response&&void 0!==t.response&&"number"==typeof t.response.status&&(e=R(t.response.status,t)),0===t.message.indexOf("timeout of")){var n=t.config.timeout;e=void 0===n||null===n?new z("MAM007E",t):new z("MAM003E",t,[n])}a(e)})})}function M(t){return new Promise(function(e,n){i.all(t).then(function(t){e(t)})})}function N(t){N.installed||(N.installed=!0,o.install(t),t.mixin({mounted:function(){this.$store&&this.$store.commit(W.SET_DIRECTION,"")}}))}function b(t){var e=null;try{e=require("../../../src/middleware/"+t+".js"),e&&(e=e.default)}catch(e){console.debug("\u627e\u4e0d\u5230\u6307\u5b9a\u7684\u4e2d\u95f4\u4ef6"+t,e)}return e}function D(t,e){null!==e&&void 0!==e?t(e):t()}function x(t){var e=[];return t.forEach(function(t){C.isEmpty(t.middleware)?C.isEmpty(t.children)||(e=e.concat(x(t.children))):e.push(t)}),e}function U(t,e){var n=t.name,r=t.matched,i=e.name,o=e.path;if(!C.isEmpty(i))return n===i;if(!C.isEmpty(r)&&!C.isEmpty(o)){var a=r[r.length-1].path;if(0!==o.indexOf("/")&&(r.forEach(function(t){0===a.indexOf(t.path)&&(a=a.substring(t.path.length))}),r.length>1&&0===a.indexOf("/")&&(a=a.substring(1))),a===o)return!0}return!1}t="default"in t?t.default:t,e="default"in e?e.default:e,n="default"in n?n.default:n,i="default"in i?i.default:i,o="default"in o?o.default:o,a="default"in a?a.default:a;var L={MAM001E:"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u8bf7\u6c42\u7684\u670d\u52a1\u8bbf\u95ee\u8d85\u65f6\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002",MAM009E:"\u5f53\u524d\u6d4f\u89c8\u5668\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u8bbf\u95ee\u672c\u5730\u5b58\u50a8\u7a7a\u95f4\u3002",MAM404E:"\u8bf7\u6c42\u7684\u670d\u52a1\u4e0d\u5b58\u5728\u3002"},C=function(){};C.isProdunctionEnv=function(){return!0},C.isFirefox=function(){var t=window.navigator.userAgent.toLowerCase();return"undefined"!=typeof window&&t&&/firefox\/\d+/.test(t)},C.getNow=function(t){return void 0===t&&(t="LL"),n().format(t)},C.formatDate=function(t,e){void 0===e&&(e="YYYY-MM-DD");var r="";return n(t).isValid()&&void 0!==t&&(r=n(t).format(e)),r},C.toDate=function(t){var e=t;return C.isEmpty(t)||(e=n(t).toDate()),e},C.addDateTime=function(t,e,r){return n(t).add(e,r)},C.subtractDateTime=function(t,e,r){return n(t).subtract(e,r)},C.isEmpty=function(t){return e.isEmpty(t)},C.isEqual=function(t,n){return e.isEqual(t,n)},C.isNumber=function(t){return e.isNumber(t)},C.isString=function(t){return e.isString(t)},C.isDate=function(t){return e.isDate(t)},C.isArray=function(t){return e.isArray(t)},C.isObject=function(t){return e.isObject(t)},C.isFunction=function(t){return e.isFunction(t)},C.get=function(t,n,r){return void 0===r&&(r=null),e.get(t,n,r)},C.cloneDeep=function(t){return e.cloneDeep(t)},C.getUrlParameter=function(t){var e=window.location.search.substring(1),n=e.split("&"),r=n.find(function(e){return e.split("=")[0]===t});return r=null===r||void 0===r?"":r.split("=")[1]};var P={$env:{},env:{dev:{},prod:{}},errorHanlder:null,message:{},router:{routes:[]},auth:{storageMode:"none"},storeSync:{}};try{var k=require((process.env.SETARIA_CONFIG_CONTEXT||process.cwd())+"/setaria.config.js");void 0!==k&&null!==k&&(P=Object.assign({},P,k.default)),P.message=Object.assign({},L,P.message)}catch(t){}var j=C.get(P,"env.dev",{}),G=C.get(P,"env.prod",{});C.isEmpty(j)&&C.isEmpty(G)&&!C.isEmpty(P.env)&&(G=P.env),P.$env=P.env,C.isProdunctionEnv()?P.env=Object.assign({},G):P.env=Object.assign({},G,j);var H=P,q={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},V=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=[]),void 0===n&&(n=""),this.id=t,this.type=d(t),this.params=e,this.message=f(this.id,this.params),C.isEmpty(this.message)&&!C.isEmpty(n)&&(this.message=n)};V.prototype.getMessage=function(){return this.message},V.prototype.toString=function(){return this.message};var F="Setaria Error",Y=":",J=function(t){function e(e,n,r){void 0===e&&(e=""),void 0===n&&(n=[]),void 0===r&&(r="");var i=r;C.isEmpty(e)&&(e="unknown"),C.isEmpty(r)&&(i=new V(e,n,r).getMessage());var o=F+"["+e+"]"+Y+i;t.call(this,o),this._name="ApplicationError",this.id=e,this.params=n,this.type=q.ERROR,this.noIdMessage=i,this.message=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),$={NORMAL_ERROR:0,PROMISE_UNREJECT_ERROR:1,VUE_ERROR:2},B=function(){};B.catchError=function(){t.config.errorHandler=function(t,e,n){B.handleError($.VUE_ERROR,t,{vm:e,info:n})},window.onerror=function(t){B.handleError($.NORMAL_ERROR,t,{})};var e=function(t){B.handleError($.PROMISE_UNREJECT_ERROR,t,{})};void 0!==window.unhandledrejectionHandler&&null!==window.unhandledrejectionHandler||(window.onunhandledrejection=e),window.addEventListener("unhandledrejection",e)},B.handleError=function(t,e,n){var r=this.parseError(t,e,n);"function"==typeof H.errorHanlder&&H.errorHanlder(r,t,e,n)},B.parseError=function(t,e,n){var r=null;return r=l(e)||t===$.NORMAL_ERROR||t===$.VUE_ERROR?m(e):t===$.PROMISE_UNREJECT_ERROR?m(e.reason):"string"==typeof e?0===e.indexOf("Uncaught Error: ")?new J("",[],e.replace("Uncaught Error: ","")):new J("",[],e):new J("MAM004E"),t===$.VUE_ERROR&&console.error(e),r};var z=function(t){function e(e,n,r,i){void 0===e&&(e=""),void 0===n&&(n={}),void 0===r&&(r=[]),void 0===i&&(i=""),t.call(this,e,r,i),this._name="ApplicationError",this.type="ServiceError",this.detail=n,C.isFirefox()&&!1!==C.get(n,"config.isShowError",!0)&&E(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(J),K="_setaria_auth_",W={MODULE_SETARIA_STORE:"_setaria_common_",GET_IS_LOADING:"_setaria_common_/_setaria_get_is_loading",GET_LOADING_COUNT:"_setaria_common_/_setaria_get_loading_count",GET_ROUTE_HISTORY:"_setaria_common_/_setaria_get_route_history",GET_ROUTE_CURRENT_INDEX:"_setaria_common_/_setaria_get_route_current_index",GET_DIRECTION:"_setaria_common_/_setaria_get_direction",SET_DIRECTION:"_setaria_common_/_setaria_set_direction",ADD_LOADING_COUNT:"_setaria_common_/_setaria_add_loading_count",SUB_LOADING_COUNT:"_setaria_common_/_setaria_sub_loading_count",UPDATE_DIRECTION:"_setaria_common_/_setaria_update_direction",UPDATE_ROUTE_HISTORY:"_setaria_common_/_setaria_update_route_history",MODULE_AUTH:K,GET_USER:"_setaria_common_/_setaria_auth_/_setaria_get_user",GET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_get_token",SET_TOKEN:"_setaria_common_/_setaria_auth_/_setaria_set_token",SET_USER:"_setaria_common_/_setaria_auth_/_setaria_set_user"},X="__Setaria_Storage_",Q={LOCAL:"local",SESSION:"session"},Z=function(){};Z.setItem=function(t,e,n){y(t,e,n)},Z.getItem=function(t,e){return O(t,e)},Z.setLocalItem=function(t,e){y(Q.LOCAL,t,e)},Z.getLocalItem=function(t){return O(Q.LOCAL,t)},Z.removeLocalItem=function(t){I(Q.LOCAL,t)},Z.clearLocal=function(){T(Q.LOCAL)},Z.setSessionItem=function(t,e){y(Q.SESSION,t,e)},Z.getSessionItem=function(t){return O(Q.SESSION,t)},Z.removeSessionItem=function(t){I(Q.SESSION,t)},Z.clearSession=function(){T(Q.SESSION)};var tt=function(t,e,n,r){var i=C.get(it(r,n),t);return void 0===i&&(i=e),i},et=function(t){return t.replace(/\//g,".")},nt=function(t){var e=Z.getItem(t,"__setaria_store_sync");return void 0!==e&&null!==e||(e={},Z.setItem(t,"__setaria_store_sync",e)),e},rt=function(t,e,n){var r=nt(t),i=C.get(r,e);C.isEmpty(i)&&(i={}),Object.assign(i,n),r[e]=i,Z.setItem(t,"__setaria_store_sync",r)},it=function(t,e){return nt(t)[e]};H&&(H.storeSync["_setaria_common_/_setaria_auth_"]=H.auth.storageMode);var ot=function(t,e,n){var r={};return w(t).forEach(function(t){var i=t.key,o=t.val,a=o;a=tt(i,o,e,n),r[i]=a}),r}({_setaria_token:"",_setaria_user:null},"_setaria_common_/_setaria_auth_",H.auth.storageMode),at={};at._setaria_get_user=function(t){return t._setaria_user},at._setaria_get_token=function(t){return t._setaria_token};var st={},ut={};ut._setaria_set_token=function(t,e){t._setaria_token=e},ut._setaria_set_user=function(t,e){t._setaria_user=e};var ct={namespaced:!0,name:"_setaria_auth_",state:ot,getters:at,actions:st,mutations:ut},_t={_setaria_direction:"",_setaria_loading:0,_setaria_routeHistory:{currentIndex:null,history:[]}},ft={};ft._setaria_get_route_history=function(t){return t._setaria_routeHistory},ft._setaria_get_route_current_index=function(t){return t._setaria_routeHistory.currentIndex},ft._setaria_get_is_loading=function(t){return 0!==t._setaria_loading},ft._setaria_get_loading_count=function(t){return t._setaria_loading},ft._setaria_get_direction=function(t){return t._setaria_direction};var dt={},lt={};lt._setaria_set_direction=function(t,e){t._setaria_direction=e},lt._setaria_add_loading_count=function(t){t._setaria_loading+=1},lt._setaria_sub_loading_count=function(t){var e=t;e._setaria_loading>0&&(e._setaria_loading-=1)},lt._setaria_update_direction=function(t,e){var n=(e.current,e.next),r=t._setaria_direction,i=t._setaria_routeHistory;if("forward"!==r&&"back"!==r){if(i.history.length>0)if(i.currentIndex===i.history.length-1)r="back";else{0!==i.currentIndex&&i.history[i.currentIndex-1]===n&&(r="back"),""===r&&i.history[i.currentIndex+1]===n&&(r="forward")}else r="forward";"forward"!==r&&"back"!==r&&(r="forward"),t._setaria_direction=r}},lt._setaria_update_route_history=function(t,e){var n=e.current,r=e.next,i=t._setaria_direction,o=t._setaria_routeHistory;if("back"===i)0===o.currentIndex?o.currentIndex=null:(o.history[o.currentIndex]=n,o.currentIndex-=1);else if("forward"===i){if(null===o.currentIndex)o.currentIndex=0;else{if(o.currentIndex<o.history.length-1){var a=o.history.splice(0,o.currentIndex+1);o.history=a}o.currentIndex+=1}o.history.push(r)}};var mt={};mt[ct.name]=ct;var Et,pt,ht={namespaced:!0,name:"_setaria_common_",state:_t,getters:ft,actions:dt,mutations:lt,modules:mt},vt=function(t){t.subscribe(function(t,e){var n=t.type;t.payload;Object.keys(H.storeSync).forEach(function(t){if(0===n.indexOf(t)){var r=H.storeSync[t];rt(r,t,C.get(e,et(t)))}})})},gt=[vt],yt={modules:(Et={},Et[ht.name]=ht,Et),plugins:gt,strict:!1},Ot={GET:"get",POST:"post",PUT:"put",DELETE:"delete",OPTIONS:"options",PATCH:"patch"},It=function(){};It.get=function(t,e,n){return A(Ot.GET,t,e,n)},It.post=function(t,e,n){return A(Ot.POST,t,e,n)},It.put=function(t,e,n){return A(Ot.PUT,t,e,n)},It.delete=function(t,e,n){return A(Ot.DELETE,t,e,n)},It.options=function(t,e,n){return A(Ot.OPTIONS,t,e,n)},It.patch=function(t,e,n){return A(Ot.PATCH,t,e,n)},It.all=function(t){return M(t)},It.spread=function(t){return i.spread(t)},t.use(a);var Tt=function(t){return null!==pt&&void 0!==pt||(pt=new t(yt)),pt}(a.Store),wt=function(t,e,n){var r=t.params,i=e.fullPath,o=Tt.state[W.GET_DIRECTION],a=t.fullPath;r&&"forward"===r.$$direction&&(o="forward",Tt.commit(W.SET_DIRECTION,o)),Tt.commit(W.UPDATE_DIRECTION,{current:i,next:a}),n()},St=function(t,e,n){var r=e.fullPath,i=t.fullPath;Tt.commit(W.UPDATE_ROUTE_HISTORY,{current:r,next:i}),n()},Rt=function(t){function e(e){var n=this;void 0===e&&(e={}),t.call(this,e);var r=this;this.beforeEach(wt),this.beforeEach(St);var i=[];if("string"==typeof e.middleware){var o=b(e.middleware);"function"==typeof o&&i.push(o)}else C.isArray(e.middleware)&&e.middleware.forEach(function(t){var e=b(t);"function"==typeof e&&i.push(e)});i.forEach(function(t){n.beforeEach(function(e,n,i){var o=t({path:e.path,query:e.query,params:e.params,name:e.name,from:n,to:e,route:r});o instanceof Promise?o.then(function(t){D(i,t)}).catch(function(t){D(i,t)}):D(i,o)})});var a=x(e.routes);C.isEmpty(a)||a.forEach(function(t){var e=b(t.middleware);C.isFunction(e)&&n.beforeEach(function(n,i,o){if(U(n,t)){var a=e({path:n.path,query:n.query,params:n.params,name:n.name,from:i,to:n,route:r});a instanceof Promise?a.then(function(t){D(o,t)}).catch(function(t){D(o,t)}):D(o,a)}else o()})}),this.afterEach(function(){Tt.commit(W.SET_DIRECTION,"")})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.forwardTo=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n={}),Tt.commit(W.SET_DIRECTION,"forward"),C.isObject(t)?this.push(t):this.push({name:t,params:e,query:n})},e.prototype.backTo=function(){t.prototype.back.call(this)},e.prototype.back=function(){Tt.commit(W.SET_DIRECTION,"back"),t.prototype.back.call(this)},e.prototype.forward=function(){Tt.commit(W.SET_DIRECTION,"forward"),t.prototype.forward.call(this)},e}(o);Rt.install=N,"undefined"!=typeof window&&t.use(Rt),C.isProdunctionEnv()&&(t.config.silent=!0,t.config.productionTip=!1);var At=new Rt(H.router);return B.catchError(),{install:s,config:H,plugin:{router:At,store:Tt},version:"0.2.8",ApplicationError:J,ServiceError:z,Http:It,Message:V,Storage:Z,storeTypes:W,util:C}});