/**
 * Setaria v0.0.8
 * (c) 2017 Ray Han
 * @license MIT
 */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue"),require("lodash"),require("moment"),require("moment/locale/zh-cn"),require("axios"),require("vue-router"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","lodash","moment","moment/locale/zh-cn","axios","vue-router","vuex"],t):n.Setaria=t(n.Vue,n._,n.moment,null,n.axios,n.VueRouter,n.Vuex)}(this,function(n,t,e,r,o,i,u){"use strict";function c(n){}function a(){return x.message?x.message:{}}function s(){return Object.assign({},b,a())}function f(n){return s()[n]}function l(n,t){void 0===n&&(n=""),void 0===t&&(t=[]);var e=f(n),r=null===e||void 0===e?"":e;return A.isEmpty(r)||A.isEmpty(t)||t.forEach(function(n,t){var e="{"+t+"}";if(-1!==r.indexOf(e)){var o="number"==typeof n?n.toString():n;r=r.split(e).join(o)}}),r}function d(n){var t="";switch(n.charAt(n.length-1)){case"E":t="error";break;case"W":t="warning";break;case"I":default:t="info"}return t}function m(n){var t=!1;return n instanceof Object&&null!==n&&void 0!==n&&null!==n.id&&void 0!==n.id?t=!0:"string"==typeof n&&(t=-1!==n.indexOf(P)),t}function p(n){var t="",e="";if("string"==typeof n){n=n.replace("Uncaught Error: ","");var r=n.split(N);return t=r[0].replace(P,"").replace("[","").replace("]",""),e=r[1],new D(t,[],e)}return new D(n.id,[],n.noIdMessage)}function v(n){var t=new D("MAM001E");if(null!==n&&void 0!==n){var e=null;switch(n){case 404:e="404";break;default:e="001"}t=new D("MAM"+e+"E")}return t}function h(n,t,e,r){return void 0===r&&(r={}),new Promise(function(i,u){var c=null,a=r;n===H.GET||n===H.DELETE||n===H.OPTIONS?(a.params=e,c=o[n](t,a)):c=o[n](t,e,a),c.then(function(n){i(n)}).catch(function(n){var t=new D("MAM001E");if(null!==n.response&&void 0!==n.response&&"number"==typeof n.response.status&&(t=v(n.response.status)),0===n.message.indexOf("timeout of")){var e=n.config.timeout;t=void 0===e||null===e?new D("MAM007E"):new D("MAM003E",[e])}u(t)})})}function E(n){return n===C.LOCAL?window.localStorage:window.sessionStorage}function g(n,t){E(n).setItem(j,JSON.stringify(t))}function y(n){var t=E(n);return null===t.getItem(j)&&t.setItem(j,JSON.stringify({})),JSON.parse(t.getItem(j))}function w(n,t,e){var r=y(n);r[t]=e,g(n,r)}function M(n,t){return y(n)[t]}function S(n,t){var e=y(n);delete e[t],g(n,e)}function I(n){g(n,{})}function O(n){O.installed||(O.installed=!0,i.install(n))}n="default"in n?n.default:n,t="default"in t?t.default:t,e="default"in e?e.default:e,o="default"in o?o.default:o,i="default"in i?i.default:i,u="default"in u?u.default:u;var x={message:null,errorHanlder:null},A=function(){};A.isProdunctionEnv=function(){return!0},A.getNow=function(n){return void 0===n&&(n="LL"),e().format(n)},A.formatDate=function(n,t){void 0===t&&(t="YYYY-MM-DD");var r="";return e(n).isValid()&&void 0!==n&&(r=e(n).format(t)),r},A.toDate=function(n){var t=n;return A.isEmpty(n)||(t=e(n).toDate()),t},A.addDateTime=function(n,t,r){return e(n).add(t,r)},A.subtractDateTime=function(n,t,r){return e(n).subtract(t,r)},A.isEmpty=function(n){return t.isEmpty(n)},A.isEqual=function(n,e){return t.isEqual(n,e)},A.isNumber=function(n){return t.isNumber(n)},A.isString=function(n){return t.isString(n)},A.isDate=function(n){return t.isDate(n)},A.isArray=function(n){return t.isArray(n)},A.isObject=function(n){return t.isObject(n)},A.isFunction=function(n){return t.isFunction(n)},A.get=function(n,e,r){return void 0===r&&(r=null),t.get(n,e,r)},A.cloneDeep=function(n){return t.cloneDeep(n)},A.getUrlParameter=function(n){var t=window.location.search.substring(1),e=t.split("&"),r=e.find(function(t){return t.split("=")[0]===n});return r=null===r||void 0===r?"":r.split("=")[1]};var b={MAM001E:"\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u672a\u77e5\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM002E:"\u7531\u4e8e\u60a8\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u767b\u5f55\u72b6\u6001\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u3002",MAM003E:"\u670d\u52a1\u672a\u5728\u9884\u5b9a\u65f6\u95f4\uff08{0}\u79d2\uff09\u5185\u8fd4\u56de\u7ed3\u679c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM004E:"\u5ba2\u6237\u7aef\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u3002",MAM005E:"\u8ba4\u8bc1\u8fc7\u671f\u6216\u65e0\u6743\u8bbf\u95ee\u6b64\u670d\u52a1\uff0c\u8bf7\u70b9\u51fb\u6ce8\u9500\u6309\u94ae\u91cd\u65b0\u767b\u5f55\u3002",MAM006E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684\u753b\u9762\u3002",MAM007E:"\u8bf7\u6c42\u7684\u670d\u52a1\u8bbf\u95ee\u8d85\u65f6\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6216\u7a0d\u540e\u91cd\u8bd5\u3002",MAM008E:"\u65e0\u6cd5\u627e\u5230\u6307\u5b9a\u7684{0}\u5b9a\u4e49\u6587\u4ef6\u3002",MAM404E:"\u8bf7\u6c42\u7684\u670d\u52a1\u4e0d\u5b58\u5728\u3002"},L={SUCCESS:"success",WARNING:"warning",INFO:"info",ERROR:"error"},T=function(n,t,e){void 0===n&&(n=""),void 0===t&&(t=[]),void 0===e&&(e=""),this.id=n,this.type=d(n),this.params=t,this.message=l(this.id,this.params),A.isEmpty(this.message)&&!A.isEmpty(e)&&(this.message=e)};T.prototype.getMessage=function(){return this.message},T.prototype.toString=function(){return this.message};var P="Setaria Error",N=":",D=function(n){function t(t,e,r){void 0===t&&(t=""),void 0===e&&(e=[]),void 0===r&&(r="");var o=r;A.isEmpty(t)&&(t="unknown"),A.isEmpty(r)&&(o=new T(t,e,r).getMessage());var i=P+"["+t+"]"+N+o;n.call(this,i),this.id=t,this.params=e,this.type=L.ERROR,this.noIdMessage=o,this.message=i}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Error),k=function(){};k.catchError=function(){n.config.errorHandler=function(n,t){k.handleError(n,t)},window.onerror=function(n){k.handleError(n)},window.onunhandledrejection=function(n){k.handleError(n)}},k.handleError=function(n,t){var e=this.parseError(n,t);"function"==typeof x.errorHanlder&&x.errorHanlder(e,n)},k.parseError=function(n,t){var e=null,r=t instanceof Object;if(m(n))e=p(n);else if(n instanceof PromiseRejectionEvent){var o=n.reason,i=o.id,u=o.message,c=o.noIdMessage;e=null!==c&&void 0!==c?new D(i,[],c):null!==u&&void 0!==u?new D("",[],u):new D("MAM004E")}else if(r&&n instanceof Error)if(A.isProdunctionEnv())e=new D("MAM004E");else{var a=n.message;e=new D("",[],a)}else e="string"==typeof n?0===n.indexOf("Uncaught Error: ")?new D("",[],n.replace("Uncaught Error: ","")):new D("",[],n):new D("MAM004E");return r&&console.error(n),e};var H={GET:"get",POST:"post",PUT:"put",DELETE:"delete",OPTIONS:"options",PATCH:"patch"},_=function(){};_.get=function(n,t,e){return h(H.GET,n,t,e)},_.post=function(n,t,e){return h(H.POST,n,t,e)},_.put=function(n,t,e){return h(H.PUT,n,t,e)},_.delete=function(n,t,e){return h(H.DELETE,n,t,e)},_.options=function(n,t,e){return h(H.OPTIONS,n,t,e)},_.patch=function(n,t,e){return h(H.PATCH,n,t,e)};var j="__Setaria_Storage_",C={LOCAL:"local",SESSION:"session"},q=function(){};q.setLocalItem=function(n,t){w(C.LOCAL,n,t)},q.getLocalItem=function(n){return M(C.LOCAL,n)},q.removeLocalItem=function(n){S(C.LOCAL,n)},q.clearLocal=function(){I(C.LOCAL)},q.setSessionItem=function(n,t){w(C.SESSION,n,t)},q.getSessionItem=function(n){return M(C.SESSION,n)},q.removeSessionItem=function(n){S(C.SESSION,n)},q.clearSession=function(){I(C.SESSION)};var R,U={direction:"",loading:!1,routeHistory:{currentIndex:null,history:[]},token:"",user:null},V={routeHistory:function(n){return n.routeHistory},routeCurrentIndex:function(n){return n.routeHistory.currentIndex}},G={},Y={direction:function(n,t){n.direction=t},loading:function(n,t){n.loading=t},token:function(n,t){n.token=t},user:function(n,t){n.user=t},updateDirection:function(n,t){var e=(t.current,t.next),r=n.direction,o=n.routeHistory;if("forward"!==r&&"back"!==r){if(o.history.length>0)if(o.currentIndex===o.history.length-1)r="back";else{0!==o.currentIndex&&o.history[o.currentIndex-1]===e&&(r="back"),""===r&&o.history[o.currentIndex+1]===e&&(r="forward")}else r="forward";"forward"!==r&&"back"!==r&&(r="forward"),n.direction=r}},updateHistory:function(n,t){var e=t.current,r=t.next,o=n.direction,i=n.routeHistory;if("back"===o)0===i.currentIndex?i.currentIndex=null:(i.history[i.currentIndex]=e,i.currentIndex-=1);else if("forward"===o){if(null===i.currentIndex)i.currentIndex=0;else{if(i.currentIndex<i.history.length-1){var u=i.history.splice(0,i.currentIndex+1);i.history=u}i.currentIndex+=1}i.history.push(r)}}},F={namespaced:!0,state:U,getters:V,actions:G,mutations:Y},J={modules:{common:F},strict:!1};n.use(u);var z=function(n){return R=new n(J)}(u.Store),W=function(n,t,e){var r=n.params,o=t.fullPath,i=z.state.common.direction,u=n.fullPath;r&&"forward"===r.$$direction&&(i="forward",z.commit("common/direction",i)),z.commit("common/updateDirection",{current:o,next:u}),e()},$=function(n,t,e){var r=t.fullPath,o=n.fullPath;z.commit("common/updateHistory",{current:r,next:o}),e()},B=function(n){function t(t){void 0===t&&(t={}),n.call(this,t),this.beforeEach(W),this.beforeEach($),this.afterEach(function(){z.commit("common/direction","")})}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.forwardTo=function(n,t,e){void 0===t&&(t={}),void 0===e&&(e={}),z.commit("common/direction","forward"),this.push({name:n,params:t,query:e})},t.prototype.push=function(t,e,r){z.commit("common/direction","forward"),n.prototype.push.call(this,t,e,r)},t.prototype.forward=function(){z.commit("common/direction","forward"),n.prototype.forward.call(this)},t.prototype.backTo=function(){z.commit("common/direction","back"),n.prototype.back.call(this)},t}(i);return B.install=O,"undefined"!=typeof window&&window.Vue&&window.Vue.use(B),A.isProdunctionEnv()&&(n.config.silent=!0,n.config.productionTip=!1),k.catchError(),{install:c,config:x,plugin:{Navigate:B,store:z},version:"0.0.8",ApplicationError:D,Http:_,Message:T,Storage:q,util:A}});